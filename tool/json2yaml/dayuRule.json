{"status":"success","data":{"groups":[{"name":"business.bigdata","file":"/thanos-prometheus/config/rules/business/bigdata.rules","rules":[{"state":"INACTIVE","name":"DataView_API指标停止","query":"sum by(exported_job) (abs(delta(AiScreen_DataView_API[2m]))) == 0","duration":60,"labels":{"alertname":"DataView_API指标停止","type":"business.bigdata"},"annotations":{"description":"DataView_API指标 {{ $labels.exported_job }} 数据停止，ROC数据源异常，涉及视频播放计时，距离，面部计数，QA计数，服务时长等数据","key":"business.bigdata.dataview_api_constant_all","summary":"DataView_API指标 {{ $labels.exported_job }} 数据停止，ROC数据源异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002073832,"lastEvaluation":"2021-04-13T18:08:58.90195997+08:00","type":"alerting"},{"state":"INACTIVE","name":"DataView_API指标出现变动","query":"delta(AiScreen_DataView_API[2m]) / (AiScreen_DataView_API offset 2m) \u003e= 1 or delta(AiScreen_DataView_API[2m]) \u003c 0","duration":60,"labels":{"alertname":"DataView_API指标出现变动","type":"business.bigdata"},"annotations":{"description":"DataView_API指标 {{ $labels.label }} 出现剧增或缩减,变动值 {{ $value }}","key":"business.bigdata.dataview_api_change","summary":"DataView_API指标 {{ $labels.label }} 出现剧增或缩减","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002832476,"lastEvaluation":"2021-04-13T18:08:58.895599146+08:00","type":"alerting"},{"state":"INACTIVE","name":"DataView_API指标连续20次未变动","query":"delta(AiScreen_DataView_API[10m]) == 0","duration":60,"labels":{"alertname":"DataView_API指标连续20次未变动","type":"business.bigdata"},"annotations":{"description":"DataView_API指标{{ $labels.label }} 连续20次未产生变动","key":"business.bigdata.dataview_api_constant","summary":"DataView_API指标{{ $labels.label }} 连续20次未产生变动","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003120768,"lastEvaluation":"2021-04-13T18:08:58.892474062+08:00","type":"alerting"},{"state":"INACTIVE","name":"DataView_BK指标出现变动","query":"delta(AiScreen_DataView_BK[2m]) != 0","duration":60,"labels":{"alertname":"DataView_BK指标出现变动","type":"business.bigdata"},"annotations":{"description":"Dataview_BK指标{{ $labels.label }} 出现变动,变动值{{ $value }}","key":"business.bigdata.dataview_bk_change","summary":"Dataview_BK指标{{ $labels.label }} 出现变动","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003521688,"lastEvaluation":"2021-04-13T18:08:58.898434918+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"business.cloudia","file":"/thanos-prometheus/config/rules/business/cloudia.rules","rules":[{"state":"INACTIVE","name":"Cloudia-fe-mail 请求http状态码 5xx","query":"delta(nginx_vts_server_requests_total{app_kubernetes_io_name=\"cloudia\",code=\"5xx\"}[1m]) \u003e 0","duration":0,"labels":{"alertname":"Cloudia-fe-mail 请求http状态码 5xx","type":"business.cloudia"},"annotations":{"description":"Cloudia fe mail 请求 {{ $labels.host }} 站点5xx状态异常,当前值{{ $value }}","key":"business.cloudia.femall.http5xx","summary":"Cloudia fe mail 请求 {{ $labels.host }} 站点5xx状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.023911601,"lastEvaluation":"2021-04-13T18:09:04.27187862+08:00","type":"alerting"},{"state":"INACTIVE","name":"Cloudia-fe-mail容器CrashLoopBackOff","query":"delta(kube_pod_container_status_waiting_reason{container=\"cloudia-fe-mall\",reason=\"CrashLoopBackOff\"}[5m]) \u003e 0","duration":5,"labels":{"alertname":"Cloudia-fe-mail容器CrashLoopBackOff","type":"business.cloudia"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace}} 容器 {{ $labels.pod }} 过去5分钟处于容器状态CrashLoopBackOff状态{{ $value }}，预期值0","key":"business.cloudia.container","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod }} 过去10分钟处于容器状态CrashLoopBackOff状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003744761,"lastEvaluation":"2021-04-13T18:09:04.268129109+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"business.smartvoice","file":"/thanos-prometheus/config/rules/business/smartvoice.rules","rules":[{"state":"INACTIVE","name":"SmartVoice三方技能耗时","query":"histogram_quantile(1, sum by(le, domain) (rate(smartvoice_main_skill_duration_ms_bucket{cloud_cluster=\"cloud-prod-1\",domain=~\"stock|currency|airport|translate|music|food|trafficrestr|times|around|constellation|twister\",kubernetes_namespace=\"smartvoice-iv-v2\"}[1m]))) \u003e 1000","duration":0,"labels":{"alertname":"SmartVoice三方技能耗时","type":"business.smartvoice"},"annotations":{"description":"SmartVoice生产环境三方技能{{ $labels.domain }}执行耗时耗时大于1s,当前值{{ $value | printf \"%s.2f\" }}","key":"business.smartvoice.thirdskill","summary":"SmartVoice生产环境三方技能{{ $labels.domain }}耗时告警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.023270037,"lastEvaluation":"2021-04-13T18:09:08.435449335+08:00","type":"alerting"},{"state":"INACTIVE","name":"SmartVoice用户QA耗时","query":"histogram_quantile(1, sum by(le, service) (rate(smartvoice_main_dm_service_cost_bucket{cloud_cluster=~\"cloud-prod-1\",kubernetes_namespace=\"smartvoice-iv-v2\",service=~\"user_qa|common_sense_qa\"}[1m]))) \u003e 1000","duration":0,"labels":{"alertname":"DM服务耗时","type":"business.smartvoice"},"annotations":{"description":"SmartVoice生产环境用户QA{{ $labels.service }}类型耗时大于1s,当前值{{ $value | printf \"%s.2f\" }}","key":"business.smartvoice.dm_delay","summary":"SmartVoice生产环境用户QA{{ $labels.service }}类型耗时告警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.0165673,"lastEvaluation":"2021-04-13T18:09:08.418877571+08:00","type":"alerting"},{"state":"INACTIVE","name":"SmartVoice用户闲聊耗时","query":"histogram_quantile(1, sum by(le, service) (rate(smartvoice_main_dm_service_cost_bucket{cloud_cluster=~\"cloud-prod-1\",kubernetes_namespace=\"smartvoice-iv-v2\",service=\"user_chitchat\"}[1m]))) \u003e 2000","duration":0,"labels":{"alertname":"DM服务耗时","type":"business.smartvoice"},"annotations":{"description":"SmartVoice生产环境用户闲聊{{ $labels.service }}类型耗时大于2s,当前值{{ $value | printf \"%s.2f\" }}","key":"business.smartvoice.chichat_delay","summary":"SmartVoice生产环境用户闲聊{{ $labels.service }}类型耗时告警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.007722507,"lastEvaluation":"2021-04-13T18:09:08.458722584+08:00","type":"alerting"},{"state":"INACTIVE","name":"第三方API失败","query":"delta(smartvoice_services_third_api_failed_total{cloud_cluster=~\"cloud-sit.*\"}[1m]) \u003e= 1","duration":0,"labels":{"alertname":"第三方API失败","type":"business.smartvoice"},"annotations":{"description":"SmartVoice生产环境第三方接口{{ $labels.api }}失败,当前值{{ $value | printf \"%s.2f\" }}","key":"business.smartvoice.third_error","summary":"Kubernetes集群{{ $labels.cloud_cluster }}内第三方{{ $labels.api }}失败大与10次","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003085585,"lastEvaluation":"2021-04-13T18:09:08.46644822+08:00","type":"alerting"},{"state":"INACTIVE","name":"第三方API耗时","query":"histogram_quantile(0.99, sum by(le, api, kubernetes_namespace, kubernetes_pod_name) (rate(smartvoice_services_third_api_execute_duration_ms_bucket{cloud_cluster=~\"cloud-prod.*\"}[1m]))) / 1000 \u003e= 1","duration":0,"labels":{"alertname":"第三方API耗时","type":"business.smartvoice"},"annotations":{"description":"SmartVoice生产环境第三方接口{{ $labels.api }}耗时大于4s,当前值{{ $value | printf \"%s.2f\" }}","key":"business.smartvoice.third_delay","summary":"Kubernetes集群{{ $labels.cloud_cluster }}内第三方{{ $labels.api }}耗时大于4s","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.034264249,"lastEvaluation":"2021-04-13T18:09:08.469537008+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"kubernetes.containers","file":"/thanos-prometheus/config/rules/kubernetes/containers.rules","rules":[{"state":"INACTIVE","name":"容器CPU使用核数","query":"rate(container_cpu_usage_seconds_total{image!=\"\",namespace!=\"\"}[2m]) \u003e 5","duration":300,"labels":{"alertname":"容器CPU使用核数","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod_name}} CPU使用大于5核心,当前值{{ $value | printf \"%.2f\" }}","key":"kubernetes.containers.cpu_used","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod_name}} CPU使用大于5核心","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.906471238,"lastEvaluation":"2021-04-13T18:09:17.608442234+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器CPU使用率","query":"sum by(cloud_cluster, namespace, pod_name, container_name) (rate(container_cpu_usage_seconds_total{cloud_cluster=~\"cloud.*\",container_name!=\"\",container_name!=\"POD\"}[5m])) / (sum by(cloud_cluster, namespace, pod_name, container_name) (container_spec_cpu_quota{cloud_cluster=~\"cloud.*\",container_name!=\"\",container_name!=\"POD\"}) / 100000) * 100 \u003e= 85 and on() hour() \u003e 0 \u003c 16","duration":60,"labels":{"alertname":"容器CPU使用率","type":"kubernetes.containers"},"annotations":{"description":"集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod_name }} CPU使用过高，当前值{{ $value| printf \"%.2f\" }}%","key":"kubrnetes.container.cpu.usage","summary":"集群 {{$labels.cloud_cluster}} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod_name }} CPU使用过高","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.228069429,"lastEvaluation":"2021-04-13T18:09:19.737068751+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器OOM Killer","query":"kubernete_docker_oom_killed == 1","duration":0,"labels":{"alertname":"容器OOM Killer","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.pod_namespace }} 容器 {{ $labels.pod }} 在主机 {{ $labels.node_ip }} 上发生OOM,状态{{ $value }}","key":"kubernetes.container.oom.fatal","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.pod_namespace }} 容器 {{ $labels.pod }} 在主机 {{ $labels.node_ip }} 上发生OOM","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005220995,"lastEvaluation":"2021-04-13T18:09:20.823154585+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器内存使用率","query":"container_memory_usage_bytes{pod_name!=\"\"} / container_spec_memory_limit_bytes{pod_name!=\"\"} * 100 != +Inf \u003e 100","duration":300,"labels":{"alertname":"容器内存使用率","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器{{ $labels.pod_name}} 内存使用率操作limit,当前值{{ $value | printf \"%.2f\" }}","key":"kubernetes.containers.memory_rate","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod_name}} 内存使用率操作limit","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":1.015479579,"lastEvaluation":"2021-04-13T18:09:18.721581833+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器内存占用","query":"(container_memory_rss{image!=\"\",namespace!=\"\"}) / 1024 / 1024 / 1024 \u003e 50","duration":3600,"labels":{"alertname":"容器内存占用","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod_name}} 内存使用大于50GB,当前值{{ $value | printf \"%.2f\" }}GB","key":"kubernetes.containers.memory_used","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod_name}} 内存使用大于50GB","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":3.738729176,"lastEvaluation":"2021-04-13T18:09:12.340395775+08:00","type":"alerting"},{"state":"PENDING","name":"容器持续Creating","query":"delta(kube_pod_container_status_waiting_reason{reason=\"ContainerCreating\"}[10m]) \u003e 0","duration":900,"labels":{"alertname":"容器持续Creating","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于Createing状态,{{ $value }}","key":"kubernetes.containers.status_creating","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于Createing状态","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"容器持续Creating","cloud_cluster":"cloud-prod-3","container":"fluent-bit","instance":"10.244.11.57:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"gemcloud-logging-system","pod":"cluster-fluentbit-rfqrk","prometheus":"standard","reason":"ContainerCreating","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-rfqrk 过去10分钟处于Createing状态,1.0290722222222222","key":"kubernetes.containers.status_creating","summary":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-rfqrk 过去10分钟处于Createing状态","trigger":"1.0290722222222222"},"state":"PENDING","activeAt":"2021-04-13T10:05:40.481121982Z","value":"1.0290722222222222e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器持续Creating","cloud_cluster":"cloud-prod-3","container":"fluent-bit","instance":"10.244.11.57:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"gemcloud-logging-system","pod":"cluster-fluentbit-96t9j","prometheus":"standard","reason":"ContainerCreating","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-96t9j 过去10分钟处于Createing状态,1.077525925925926","key":"kubernetes.containers.status_creating","summary":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-96t9j 过去10分钟处于Createing状态","trigger":"1.077525925925926"},"state":"PENDING","activeAt":"2021-04-13T10:01:40.481121982Z","value":"1.077525925925926e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.42671939,"lastEvaluation":"2021-04-13T18:09:16.079133868+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器状态ContainerCannotRun","query":"delta(kube_pod_container_status_terminated_reason{reason=\"ContainerCannotRun\"}[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态ContainerCannotRun","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod }} 过去10分钟处于容器状态ContainerCannotRun状态{{ $value }}次","key":"kubernetes.containers.status_containercannotrun","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod }} 过去10分钟处于容器状态ContainerCannotRun状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.217685702,"lastEvaluation":"2021-04-13T18:09:20.196969721+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器状态CrashLoopBackOff","query":"delta(kube_pod_container_status_waiting_reason{reason=\"CrashLoopBackOff\"}[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态CrashLoopBackOff","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod }} 过去10分钟处于容器状态CrashLoopBackOff状态,{{ $value }}","key":"kubernetes.containers.status_crashloopbackoff","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod }} 过去10分钟处于容器状态CrashLoopBackOff状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.231817101,"lastEvaluation":"2021-04-13T18:09:19.965145283+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器状态CreateContainerConfigError","query":"delta(kube_pod_container_status_waiting_reason{reason=\"CreateContainerConfigError\"}[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态CreateContainerConfigError","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于CreateContainerConfigError状态，{{ $value }}","key":"kubernetes.containers.status_createcontainerconfigerror","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于CreateContainerConfigError状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":1.85901453,"lastEvaluation":"2021-04-13T18:09:10.481371492+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器状态ErrImagePull","query":"delta(kube_pod_container_status_waiting_reason{reason=\"ErrImagePull\"}[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态ErrImagePull","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于ErrImagePull状态,{{ $value }}","key":"kubernetes.containers.status_errimagepull","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于ErrImagePull状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.230813244,"lastEvaluation":"2021-04-13T18:09:17.377624454+08:00","type":"alerting"},{"state":"FIRING","name":"容器状态Error","query":"delta(kube_pod_container_status_terminated_reason{reason=\"Error\"}[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态Error","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于Error状态,{{ $value }}","key":"kubernetes.containers.status_error","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于Error状态","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"容器状态Error","cloud_cluster":"cloud-prod-3","container":"fluent-bit","instance":"10.244.11.57:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"gemcloud-logging-system","pod":"cluster-fluentbit-mmjf4","prometheus":"standard","reason":"Error","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-mmjf4 过去10分钟处于Error状态,1.0498380952380952","key":"kubernetes.containers.status_error","summary":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-mmjf4 过去10分钟处于Error状态","trigger":"1.0498380952380952"},"state":"FIRING","activeAt":"2021-04-13T10:03:10.481121982Z","value":"1.0498380952380952e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Error","cloud_cluster":"cloud-prod-3","container":"fluent-bit","instance":"10.244.11.57:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"gemcloud-logging-system","pod":"cluster-fluentbit-l47l5","prometheus":"standard","reason":"Error","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-l47l5 过去10分钟处于Error状态,1.0449057471264367","key":"kubernetes.containers.status_error","summary":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器 cluster-fluentbit-l47l5 过去10分钟处于Error状态","trigger":"1.0449057471264367"},"state":"PENDING","activeAt":"2021-04-13T10:09:10.481121982Z","value":"1.0449057471264367e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.206659491,"lastEvaluation":"2021-04-13T18:09:18.514917129+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器状态ImagePullBackOff","query":"delta(kube_pod_container_status_waiting_reason{reason=\"ImagePullBackOff\"}[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态ImagePullBackOff","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于ImagePullBackOff状态,{{ $value }}","key":"kubernetes.containers.status_imagepullbackoff","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于ImagePullBackOff状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.252713614,"lastEvaluation":"2021-04-13T18:09:16.924194454+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器状态OOMKilled","query":"kube_pod_container_status_terminated_reason{reason=\"OOMKilled\"} \u003e 0","duration":0,"labels":{"alertname":"容器状态OOMKilled","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于OOMKilled状态{{ $value }}次","key":"kubernetes.containers.status_oomkilled","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于OOMKilled状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.200703858,"lastEvaluation":"2021-04-13T18:09:17.176914322+08:00","type":"alerting"},{"state":"FIRING","name":"容器状态Restart","query":"delta(kube_pod_container_status_restarts_total[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态Restart","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于restart状态{{ $value }}次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于restart状态","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-sit-2","container":"cms-mark-portal","instance":"10.244.20.196:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"smartomp-cloudpepper-v3-uit","pod":"stable-cms-mark-portal-7b4499d6c6-74hwt","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 smartomp-cloudpepper-v3-uit 容器 stable-cms-mark-portal-7b4499d6c6-74hwt 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-sit-2 命名空间 smartomp-cloudpepper-v3-uit 容器 stable-cms-mark-portal-7b4499d6c6-74hwt 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-04-12T11:15:10.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-prod-4","container":"nlp-disease-classfy","instance":"10.58.0.250:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"smartvoice-nlp-251","pod":"stable-nlp-disease-classfy-5f54b6856d-d796k","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-prod-4 命名空间 smartvoice-nlp-251 容器 stable-nlp-disease-classfy-5f54b6856d-d796k 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-prod-4 命名空间 smartvoice-nlp-251 容器 stable-nlp-disease-classfy-5f54b6856d-d796k 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-03-19T01:38:40.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-prod-4","container":"ingress-controller","instance":"10.58.0.250:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"kong","pod":"ingress-kong-775fd5447c-5bcql","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-prod-4 命名空间 kong 容器 ingress-kong-775fd5447c-5bcql 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-prod-4 命名空间 kong 容器 ingress-kong-775fd5447c-5bcql 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-03-16T03:46:10.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-sit-2","container":"cv-container","instance":"10.244.20.196:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"harix-cv-v3-110","pod":"stable-cv-container-67945ffd84-l94wq","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 harix-cv-v3-110 容器 stable-cv-container-67945ffd84-l94wq 过去10分钟处于restart状态2.03472次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-sit-2 命名空间 harix-cv-v3-110 容器 stable-cv-container-67945ffd84-l94wq 过去10分钟处于restart状态","trigger":"2.03472"},"state":"FIRING","activeAt":"2021-04-13T09:55:40.481121982Z","value":"2.03472e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-sit-2","container":"crss-mobile-gateway","instance":"10.244.20.196:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"crss-plus-uit","pod":"stable-crss-mobile-gateway-75764fdff7-bvj5s","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 crss-plus-uit 容器 stable-crss-mobile-gateway-75764fdff7-bvj5s 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-sit-2 命名空间 crss-plus-uit 容器 stable-crss-mobile-gateway-75764fdff7-bvj5s 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-04-12T11:15:10.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-sit-2","container":"map-gateway","instance":"10.244.20.196:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"harix-map-cloudpepper-v3-138","pod":"stable-map-gateway-549d85f985-tsxpw","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 harix-map-cloudpepper-v3-138 容器 stable-map-gateway-549d85f985-tsxpw 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-sit-2 命名空间 harix-map-cloudpepper-v3-138 容器 stable-map-gateway-549d85f985-tsxpw 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-04-12T11:15:10.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-sit-2","container":"smartvoice-wordseg","instance":"10.244.20.196:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"smartvoice-cloudpepper-v3-138","pod":"stable-smartvoice-wordseg-7595848f87-bt96x","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 smartvoice-cloudpepper-v3-138 容器 stable-smartvoice-wordseg-7595848f87-bt96x 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-sit-2 命名空间 smartvoice-cloudpepper-v3-138 容器 stable-smartvoice-wordseg-7595848f87-bt96x 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-04-12T11:15:10.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-sit-2","container":"map-schedule-service","instance":"10.244.20.196:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"harix-map-cloudpepper-v3-138","pod":"stable-map-schedule-service-6d8f6c958d-s72vh","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 harix-map-cloudpepper-v3-138 容器 stable-map-schedule-service-6d8f6c958d-s72vh 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-sit-2 命名空间 harix-map-cloudpepper-v3-138 容器 stable-map-schedule-service-6d8f6c958d-s72vh 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-04-12T11:15:10.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-prod-4","container":"binlog-pdns-mysql-vbn-mcs","instance":"10.58.0.250:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"dms","pod":"binlog-pdns-mysql-vbn-mcs-86bf499584-nt4v5","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-prod-4 命名空间 dms 容器 binlog-pdns-mysql-vbn-mcs-86bf499584-nt4v5 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-prod-4 命名空间 dms 容器 binlog-pdns-mysql-vbn-mcs-86bf499584-nt4v5 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-03-16T03:46:40.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"容器状态Restart","cloud_cluster":"cloud-sit-2","container":"map-api-service","instance":"10.244.20.196:8080","job":"kubernetes-service-endpoints","k8s_app":"kube-state-metrics","kubernetes_name":"kube-state-metrics","kubernetes_namespace":"monitor","namespace":"harix-map-cloudpepper-v3-138","pod":"stable-map-api-service-788c6b894f-cwn54","prometheus":"standard","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 harix-map-cloudpepper-v3-138 容器 stable-map-api-service-788c6b894f-cwn54 过去10分钟处于restart状态2.051282051282051次","key":"kubernetes.containers.restart_fatal","summary":"Kubernetes集群 cloud-sit-2 命名空间 harix-map-cloudpepper-v3-138 容器 stable-map-api-service-788c6b894f-cwn54 过去10分钟处于restart状态","trigger":"2.051282051282051"},"state":"FIRING","activeAt":"2021-04-12T11:15:10.481121982Z","value":"2.051282051282051e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.231333099,"lastEvaluation":"2021-04-13T18:09:20.591815149+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器状态Unknown","query":"delta(kube_pod_status_phase{phase=\"Unknown\"}[10m]) \u003e 0","duration":180,"labels":{"alertname":"容器状态Unknown","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于Unknown状态{{ $value }}次","key":"kubernetes.containers.status_unknown","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 过去10分钟处于Unknown状态","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.177145926,"lastEvaluation":"2021-04-13T18:09:20.41466203+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器网络延迟","query":"kubernete_tcp_outer_delay \u003e 100 or kubernete_tcp_delay \u003e 100","duration":60,"labels":{"alertname":"容器网络延迟","type":"kubernetes.containers"},"annotations":{"description":"Kubernetes集群{{ $labels.cloud_cluster }} 容器 {{ $labels.exported_instance }} 网络延迟 \u003e 100ms,当前值 {{ $value }}","key":"kubernetes.containers.network_delay","summary":"Kubernetes集群{{ $labels.cloud_cluster }} 容器 {{ $labels.exported_instance }} 网络延迟 \u003e 100ms","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.418330567,"lastEvaluation":"2021-04-13T18:09:16.505858394+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"kubernetes.kubelet","file":"/thanos-prometheus/config/rules/kubernetes/kubelet.rules","rules":[{"state":"INACTIVE","name":"容器节点DiskPressure状态","query":"sum by(node, cloud_cluster) (kube_node_status_condition{condition=\"DiskPressure\",status=\"true\"}) == 1","duration":300,"labels":{"alertname":"容器节点DiskPressure状态","type":"kubernetes.kubelet"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} DiskPressure状态异常,状态{{ $value }},预期0","key":"kubernetes.kubelet.status_diskpressure","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} DiskPressure状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.092692407,"lastEvaluation":"2021-04-13T18:08:56.812914272+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器节点MemoryPressure状态","query":"sum by(node, cloud_cluster) (kube_node_status_condition{condition=\"MemoryPressure\",status=\"true\"}) == 1","duration":300,"labels":{"alertname":"容器节点MemoryPressure状态","type":"kubernetes.kubelet"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} MemoryPressure状态异常,状态{{ $value }},预期0","key":"kubernetes.kubelet.status_memorypressure","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} MemoryPressure状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.0055409,"lastEvaluation":"2021-04-13T18:08:56.905612973+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器节点OutOfDisk状态","query":"sum by(node, cloud_cluster) (kube_node_status_condition{condition=\"OutOfDisk\",status=\"false\"}) == 0","duration":60,"labels":{"alertname":"容器节点OutOfDisk状态","type":"kubernetes.kubelet"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} OutOfDisk状态异常,状态{{ $value }},预期1","key":"kubernetes.kubelet.status_outofdisk","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} OutOfDisk状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002388499,"lastEvaluation":"2021-04-13T18:08:56.911157326+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器节点PIDPressure状态","query":"sum by(node, cloud_cluster) (kube_node_status_condition{condition=\"PIDPressure\",status=\"true\"}) == 1","duration":60,"labels":{"alertname":"容器节点PIDPressure状态","type":"kubernetes.kubelet"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} PIDPressure状态异常, 状态{{ $value }},预期0","key":"kubernetes.kubelet.status_pidpressure","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} PIDPressure状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005866376,"lastEvaluation":"2021-04-13T18:08:56.807040951+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器节点Ready状态","query":"sum by(node, cloud_cluster) (kube_node_status_condition{condition=\"Ready\",status=\"true\"}) == 0","duration":300,"labels":{"alertname":"容器节点Ready状态","type":"kubernetes.kubelet"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} Ready状态异常,状态{{ $value }},预期1","key":"kubernetes.kubelet.status_ready","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器节点 {{ $labels.node }} Ready状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005496629,"lastEvaluation":"2021-04-13T18:08:56.913548207+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"kubernetes.network","file":"/thanos-prometheus/config/rules/kubernetes/network.rules","rules":[{"state":"FIRING","name":"容器Close_Wait状态","query":"K8S_DOCKER_TCP_CONNECT_STATUS{status=\"CLOSE_WAIT\"} \u003e 200","duration":60,"labels":{"alertname":"容器Close_Wait状态","type":"kubernetes.network"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.pod_namespace }} 容器 {{ $labels.pod_name }} CLOSE_WAIT异常,数量{{ $value }}个","key":"kubernetes.network.close_wait","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.pod_namespace }} 容器 {{ $labels.pod_name}} CLOSE_WAIT异常","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"容器Close_Wait状态","app_kubernetes_io_xaaszone_bj_prod_232":"bj-prod-232","beta_kubernetes_io_arch":"amd64","beta_kubernetes_io_os":"linux","cloud_cluster":"cloud-prod-3","group":"gpu","instance":"l-172016031024-ops.cloudminds.com","job":"kubernetes-nodes-cloud","kubernetes_io_arch":"amd64","kubernetes_io_hostname":"l-172016031024-ops.cloudminds.com","kubernetes_io_os":"linux","media_location":"beijing-patrol","node_ip":"172.16.31.24","pod":"cluster-fluentd-0","pod_docker_id":"69a539cad716","pod_namespace":"gemcloud-logging-system","prometheus":"standard","run_ue4":"true","status":"CLOSE_WAIT","tencent_com_vcuda":"true","type":"kubernetes.network"},"annotations":{"description":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器  CLOSE_WAIT异常,数量946个","key":"kubernetes.network.close_wait","summary":"Kubernetes集群 cloud-prod-3 命名空间 gemcloud-logging-system 容器  CLOSE_WAIT异常","trigger":"946"},"state":"FIRING","activeAt":"2021-04-13T09:45:45.164893082Z","value":"9.46e+02","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.388113437,"lastEvaluation":"2021-04-13T18:09:16.06658438+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器内网延迟","query":"kubernete_tcp_delay \u003e 500","duration":300,"labels":{"alertname":"容器内网延迟","type":"kubernetes.network"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器 {{ $labels.exported_instance }} 内网延迟预警，当前 {{ $value | printf \"%.2f\" }}ms","key":"kubernetes.network.inerdelay","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器 {{ $labels.exported_instance }} 内网延迟预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.282508298,"lastEvaluation":"2021-04-13T18:09:15.784071586+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器外网延迟","query":"kubernete_tcp_outer_delay \u003e 800","duration":300,"labels":{"alertname":"容器外网延迟","type":"kubernetes.network"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器 {{ $labels.exported_instance }} 外网延迟预警，当前 {{ $value | printf \"%.2f\" }}ms","key":"kubernetes.network.outerdelay","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 容器 {{ $labels.exported_instance }} 外网延迟预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.618890511,"lastEvaluation":"2021-04-13T18:09:15.165175149+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"kubernetes.pvc","file":"/thanos-prometheus/config/rules/kubernetes/pvc.rules","rules":[{"state":"INACTIVE","name":"容器pvc_inode使用率","query":"kubelet_volume_stats_inodes_used{cloud_cluster=~\"cloud-prod.*\"} / kubelet_volume_stats_inodes{cloud_cluster=~\"cloud-prod.*\"} * 100 \u003e 90","duration":43200,"labels":{"alertname":"容器pvc_inode使用率","type":"kubernetes.pvc"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 磁盘 {{ $labels.persistentvolumeclaim}} Inode使用率预警,当前使用率 {{ $value | printf \"%.2f\" }}%","key":"kubernetes.pvc.inode_rate","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 磁盘 {{ $labels.persistentvolumeclaim}} Inode使用率预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.134598924,"lastEvaluation":"2021-04-13T18:09:17.623347629+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器pvc_inode未来48小时满额预测","query":"predict_linear(kubelet_volume_stats_inodes_free[2h], 48 * 3600) \u003c 0","duration":43200,"labels":{"alertname":"容器pvc_inode未来48小时满额预测","type":"kubernetes.pvc"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 设备 {{ $labels.persistentvolumeclaim }} inode未来24小时满额预警, 可能超出{{ $value | printf \"%.2f\" }}","key":"nodes.disk.pvc.inode_predict_linear","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 设备 {{ $labels.persistentvolumeclaim }} inode未来24小时满额预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.230645307,"lastEvaluation":"2021-04-13T18:09:17.757954905+08:00","type":"alerting"},{"state":"INACTIVE","name":"容器pvc使用率","query":"kubernete_pvc_used * 100 \u003e 90","duration":600,"labels":{"alertname":"容器pvc使用率","type":"kubernetes.pvc"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.pod_namespace }} 容器 {{ $labels.pod_name }} 磁盘 {{ $labels.pvc}} 设备 {{ $labels.volume }} 使用率预警,当前 {{ $value | printf \"%.2f\" }}%","key":"kubernetes.pvc.volume_rate","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.pod_namespace }} 容器 {{ $labels.pod_name }} 磁盘 {{ $labels.pvc }} 设备 {{ $labels.volume }} 使用率预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.102033078,"lastEvaluation":"2021-04-13T18:09:17.521311165+08:00","type":"alerting"},{"state":"PENDING","name":"容器pvc未来48小时满额预测","query":"predict_linear(kubelet_volume_stats_available_bytes[2h], 48 * 3600) / 1024 / 1024 / 1024 \u003c 0","duration":43200,"labels":{"alertname":"容器pvc未来48小时满额预测","type":"kubernetes.pvc"},"annotations":{"description":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 设备 {{ $labels.persistentvolumeclaim }} 未来24小时满额预警, 可能超出{{ $value | printf \"%.2f\" }}GB","key":"nodes.disk.pvc.predict_linear","summary":"Kubernetes集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 设备 {{ $labels.persistentvolumeclaim }} 未来24小时满额预警","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"容器pvc未来48小时满额预测","app":"harix-media-gateway-138","app_kubernetes_io_xaaszone_bj_sit_138":"bj-sit-138","app_kubernetes_io_xaaszone_bj_uit_85":"bj-uit-85","app_kubernetes_io_xaaszone_cloud_sit_2":"cloud-sit-2","beta_kubernetes_io_arch":"amd64","beta_kubernetes_io_os":"linux","cloud_cluster":"cloud-sit-2","fras_icegrid":"true","instance":"l-172016023088-ops.cloudminds.com","job":"kubernetes-nodes-kubelet","kubernetes_io_arch":"amd64","kubernetes_io_hostname":"l-172016023088-ops.cloudminds.com","kubernetes_io_os":"linux","media_location":"138-patrol","namespace":"lpc-baas-dit","omaRocDm":"dit","persistentvolumeclaim":"geth-pvc-03c87c7a07254c9","prometheus":"standard","run_harix":"true","run_harix_137":"true","run_harix_137_auto_test_label":"true","run_harix_137_ingress_label":"true","run_harix_137_map":"true","run_harix_137_media_gateway_label":"true","run_harix_137_roc_label":"true","run_harix_auto_test":"true","run_harix_ingress":"true","run_harix_kafka":"true","run_harix_map":"true","run_harix_media_gateway":"true","run_harix_rdp":"true","run_harix_roc":"true","run_harix_tools":"true","run_harix_tools_elk_elasticsearch_multi_data":"true","run_harix_tools_elk_elasticsearch_multi_master":"true","run_harix_tools_elk_multi_logstash":"true","sgx_node":"true","type":"kubernetes.pvc"},"annotations":{"description":"Kubernetes集群 cloud-sit-2 命名空间 lpc-baas-dit 设备 geth-pvc-03c87c7a07254c9 未来24小时满额预警, 可能超出-0.08GB","key":"nodes.disk.pvc.predict_linear","summary":"Kubernetes集群 cloud-sit-2 命名空间 lpc-baas-dit 设备 geth-pvc-03c87c7a07254c9 未来24小时满额预警","trigger":"-0.08321402745610906"},"state":"PENDING","activeAt":"2021-04-13T09:30:17.326015946Z","value":"-8.321402745610906e-02","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.195031746,"lastEvaluation":"2021-04-13T18:09:17.326271639+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"middleware.cloud-dns","file":"/thanos-prometheus/config/rules/middleware/cloud-dns.rules","rules":[{"state":"INACTIVE","name":"DNS大陆地区域名请求延时","query":"histogram_quantile(0.99, sum by(le) (rate(coredns_proxy_request_duration_seconds_bucket{job=\"cloud-coredns\",to!~\"127.*\"}[2m]))) \u003e 30","duration":60,"labels":{"alertname":"DNS大陆地区域名请求延时","type":"middleware.cloud-dns"},"annotations":{"description":"Cloud DNS大陆地区域名解析服务延迟告警","key":"middleware.cloud-dns.china","summary":"Cloud DNS大陆地区请求延时告警, 当前值{{ $value }}s","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.012228296,"lastEvaluation":"2021-04-13T18:09:18.445618635+08:00","type":"alerting"},{"state":"INACTIVE","name":"DNS平均域名请求延时","query":"histogram_quantile(0.99, sum by(le) (rate(coredns_forward_request_duration_seconds_bucket{job=\"cloud-coredns\"}[2m]))) \u003e 30","duration":60,"labels":{"alertname":"DNS平均域名请求延时","type":"middleware.cloud-dns"},"annotations":{"description":"Cloud DNS域名解析服务延迟告警","key":"middleware.cloud-dns.google","summary":"Cloud DNS地区请求延时告警, 当前值{{ $value }}s","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.010368834,"lastEvaluation":"2021-04-13T18:09:18.435245546+08:00","type":"alerting"},{"state":"INACTIVE","name":"DNS海外地区域名请求延时","query":"histogram_quantile(0.99, sum by(le) (rate(coredns_forward_request_duration_seconds_bucket{job=\"cloud-coredns\",to=~\"8.8.*\"}[2m]))) \u003e 30","duration":60,"labels":{"alertname":"DNS海外地区域名请求延时","type":"middleware.cloud-dns"},"annotations":{"description":"Cloud DNS海外域名解析服务延迟告警","key":"middleware.cloud-dns.google.warning","summary":"Cloud DNS海外地区请求延时告警, 当前值{{ $value }}s","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005993876,"lastEvaluation":"2021-04-13T18:09:18.505460562+08:00","type":"alerting"},{"state":"INACTIVE","name":"DNS达闼域名请求延时","query":"histogram_quantile(0.99, sum by(le) (rate(coredns_forward_request_duration_seconds_bucket{job=\"cloud-coredns\",to!~\"127.*|8.8.*\"}[2m]))) \u003e 30","duration":60,"labels":{"alertname":"DNS达闼域名请求延时","type":"middleware.cloud-dns"},"annotations":{"description":"Cloud DNS达闼VBN域名解析服务延迟告警","key":"middleware.cloud-dns.vbn","summary":"Cloud DNS达闼VBN地区请求延时告警, 当前值{{ $value }}s","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.047607647,"lastEvaluation":"2021-04-13T18:09:18.457850895+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"middleware.cloud-logs","file":"/thanos-prometheus/config/rules/middleware/cloud-logs.rules","rules":[{"state":"INACTIVE","name":"Cloud-Prod-1集群flume消费端Source_Received_Count","query":"abs(delta(FLUME_SOURCE_EventReceivedCount{cloud_cluster=\"cloud-prod-1\"}[1h])) == 0","duration":300,"labels":{"alertname":"Cloud-Prod-1集群flume消费端Source_Received_Count","type":"middleware.cloud-logs"},"annotations":{"description":"集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 1小时内连续为0 {{ $value }}","key":"middleware.cloud-logs.flume_srouce_received.prod-1","summary":"集群 {{ $labels.cloud_cluster }} Flume客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 事件接收异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003448933,"lastEvaluation":"2021-04-13T18:09:13.932226809+08:00","type":"alerting"},{"state":"INACTIVE","name":"Cloud-Prod-3集群Flume消费端Source Received Count","query":"abs(delta(FLUME_SOURCE_EventReceivedCount{cloud_cluster=\"cloud-prod-3\",name!~\"source_from_kafka|source_from_smartvoice\"}[1h])) == 0","duration":300,"labels":{"alertname":"Cloud-Prod-3集群Flume消费端Source Received Count","type":"middleware.cloud-logs"},"annotations":{"description":"集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 1小时内连续为0 {{ $value }}","key":"middleware.cloud-logs.flume_srouce_received","summary":"集群 {{ $labels.cloud_cluster }} Flume客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 事件接收异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.006773412,"lastEvaluation":"2021-04-13T18:09:13.925448657+08:00","type":"alerting"},{"state":"INACTIVE","name":"Cloud-Prod-4集群Flume消费端Source Received Count","query":"abs(delta(FLUME_SOURCE_EventReceivedCount{cloud_cluster=\"cloud-prod-4\",name!~\"source_from_kafka|source_from_smartvoice |source_from_smartvoice-asrctrl\"}[1h])) == 0","duration":300,"labels":{"alertname":"Cloud-Prod-4集群Flume消费端Source Received Count","type":"middleware.cloud-logs"},"annotations":{"description":"集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 1小时内连续为0 {{ $value }}","key":"middleware.cloud-logs.flume_srouce_received.prod-4","summary":"集群 {{ $labels.cloud_cluster }} Flume客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 事件接收异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003350746,"lastEvaluation":"2021-04-13T18:09:13.292598557+08:00","type":"alerting"},{"state":"INACTIVE","name":"Fluentd客户端容器状态","query":"kube_pod_container_status_running{container=\"log-agent\",namespace=\"cloud-logs\"} == 0","duration":60,"labels":{"alertname":"Fluentd客户端容器状态","type":"middleware.cloud-logs"},"annotations":{"description":"日志客户端 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}} 状态{{ $value }}异常，预期状态1","key":" middleware.cloud-logs.agent_status","summary":"日志客户端{{ $labels.cloud_cluster }} 命名空间 {{ $labels.namespace }} 容器 {{ $labels.pod}}状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.025946392,"lastEvaluation":"2021-04-13T18:09:11.528367623+08:00","type":"alerting"},{"state":"INACTIVE","name":"Fluentd客户端日志缓冲空间","query":"sum by(cloud_cluster, kubernetes_pod_name, type) (fluentd_output_status_queue_byte_size) / 1024 / 1024 / 1024 \u003e 1 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 23","duration":300,"labels":{"alertname":"Fluentd客户端日志缓冲空间","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 出现缓冲堆积 {{ $value | printf \"%.2f\" }} GB","key":"middleware.cloud-logs.fluentd_queue_size","summary":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 缓冲堆积","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.496110044,"lastEvaluation":"2021-04-13T18:09:12.79648178+08:00","type":"alerting"},{"state":"INACTIVE","name":"Fluentd客户端日志输出错误","query":"sum by(cloud_cluster, kubernetes_pod_name, plugin_id) (rate(fluentd_output_status_num_errors[1m])) \u003e 5 and on() hour() \u003e 0 \u003c 15","duration":300,"labels":{"alertname":"Fluentd客户端日志输出错误","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 出口 {{ $labels.plugin_id }} 发生错误 {{ $value }} 次","key":"middleware.cloud-logs.fluentd_output_error","summary":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 出口 {{ $labels.plugin_id }} 发生错误","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":1.2421594790000001,"lastEvaluation":"2021-04-13T18:09:11.554316408+08:00","type":"alerting"},{"state":"INACTIVE","name":"Fluentd客户端日志错误重试","query":"sum by(cloud_cluster, kubernetes_pod_name, type) (fluentd_output_status_retry_wait) \u003e 500 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 23","duration":300,"labels":{"alertname":"Fluentd客户端日志错误重试","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 重试 {{ $value }} 次","key":"middleware.cloud-logs.fluentd_output_retry","summary":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 大量重试","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.284675882,"lastEvaluation":"2021-04-13T18:09:13.640767875+08:00","type":"alerting"},{"state":"FIRING","name":"Flume消费端Channel Size","query":"FLUME_CHANNEL_ChannelSize \u003e 80 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 23","duration":900,"labels":{"alertname":"Flume消费端Channel Size","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} Size过大，当前 {{ $value }}%","key":"middleware.cloud-logs.flume_channel_size","summary":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} Size过大","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"Flume消费端Channel Size","app":"cloud-log-flume","app_image_version":"v0.5","app_instance":"stable","app_kubernetes_io_name":"cloud-logs","cloud_cluster":"cloud-sit-2","host":"localhost:41414","instance":"10.244.2.127:9360","job":"kubernetes-pods","kubernetes_namespace":"cloud-logs","kubernetes_pod_name":"stable-cloud-log-flume-5977785865-4nnrd","log_collect":"true","name":"source_from_harix_channel","pod_template_hash":"5977785865","prometheus":"middleware","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 cloud-sit-2 日志采集客户端 stable-cloud-log-flume-5977785865-4nnrd 类型 CHANNEL 名称 source_from_harix_channel Size过大，当前 159200%","key":"middleware.cloud-logs.flume_channel_size","summary":"生产环境集群 cloud-sit-2 日志采集客户端 stable-cloud-log-flume-5977785865-4nnrd 类型 CHANNEL 名称 source_from_harix_channel Size过大","trigger":"159200"},"state":"FIRING","activeAt":"2021-04-13T09:14:11.528077126Z","value":"1.592e+05","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"Flume消费端Channel Size","app":"cloud-log-flume","app_image_version":"v0.5","app_instance":"stable","app_kubernetes_io_name":"cloud-logs","cloud_cluster":"cloud-prod-1","host":"localhost:41414","instance":"10.152.28.121:9360","job":"kubernetes-pods","kubernetes_namespace":"cloud-logs","kubernetes_pod_name":"stable-cloud-log-flume-5dd55f6d6-mvk47","log_collect":"true","name":"source_from_kafka_channel","pod_template_hash":"188119282","prometheus":"middleware","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 cloud-prod-1 日志采集客户端 stable-cloud-log-flume-5dd55f6d6-mvk47 类型 CHANNEL 名称 source_from_kafka_channel Size过大，当前 95%","key":"middleware.cloud-logs.flume_channel_size","summary":"生产环境集群 cloud-prod-1 日志采集客户端 stable-cloud-log-flume-5dd55f6d6-mvk47 类型 CHANNEL 名称 source_from_kafka_channel Size过大","trigger":"95"},"state":"PENDING","activeAt":"2021-04-13T10:09:11.528077126Z","value":"9.5e+01","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.080751193,"lastEvaluation":"2021-04-13T18:09:13.560009855+08:00","type":"alerting"},{"state":"FIRING","name":"Flume消费端Sink DrainSuccess Count","query":"abs(delta(FLUME_SINK_EventDrainSuccessCount[2m])) == 0","duration":900,"labels":{"alertname":"Flume消费端Sink DrainSuccess Count","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 2分钟内连续为0 {{ $value }}","key":"middleware.cloud-logs.flume_sink_drain_success","summary":"生产环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 事件接收异常","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"Flume消费端Sink DrainSuccess Count","app":"cloud-log-flume","app_image_version":"v0.5","app_instance":"stable","app_kubernetes_io_name":"cloud-logs","cloud_cluster":"cloud-prod-3","host":"localhost:41414","instance":"10.244.11.108:9360","job":"kubernetes-pods","kubernetes_namespace":"cloud-logs","kubernetes_pod_name":"stable-cloud-log-flume-7b4bf76644-br5bf","log_collect":"true","name":"source_from_kafka_sink","pod_template_hash":"7b4bf76644","prometheus":"middleware","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 cloud-prod-3 日志采集客户端 stable-cloud-log-flume-7b4bf76644-br5bf 类型 SINK 名称 source_from_kafka_sink 2分钟内连续为0 0","key":"middleware.cloud-logs.flume_sink_drain_success","summary":"生产环境集群 cloud-prod-3 日志采集客户端 stable-cloud-log-flume-7b4bf76644-br5bf 类型 SINK 名称 source_from_kafka_sink 事件接收异常","trigger":"0"},"state":"FIRING","activeAt":"2021-04-06T14:41:41.528077126Z","value":"0e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"Flume消费端Sink DrainSuccess Count","app":"cloud-log-flume","app_image_version":"v0.5","app_instance":"stable","app_kubernetes_io_name":"cloud-logs","cloud_cluster":"cloud-prod-4","host":"localhost:41414","instance":"10.58.0.226:9360","job":"kubernetes-pods","kubernetes_namespace":"cloud-logs","kubernetes_pod_name":"stable-cloud-log-flume-774c778c98-rw5ct","log_collect":"true","name":"source_from_smartvoice-asrctrl_sink","pod_template_hash":"774c778c98","prometheus":"middleware","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 cloud-prod-4 日志采集客户端 stable-cloud-log-flume-774c778c98-rw5ct 类型 SINK 名称 source_from_smartvoice-asrctrl_sink 2分钟内连续为0 0","key":"middleware.cloud-logs.flume_sink_drain_success","summary":"生产环境集群 cloud-prod-4 日志采集客户端 stable-cloud-log-flume-774c778c98-rw5ct 类型 SINK 名称 source_from_smartvoice-asrctrl_sink 事件接收异常","trigger":"0"},"state":"FIRING","activeAt":"2021-04-13T09:51:41.528077126Z","value":"0e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"Flume消费端Sink DrainSuccess Count","app":"cloud-log-flume","app_image_version":"v0.5","app_instance":"stable","app_kubernetes_io_name":"cloud-logs","cloud_cluster":"cloud-prod-4","host":"localhost:41414","instance":"10.58.0.226:9360","job":"kubernetes-pods","kubernetes_namespace":"cloud-logs","kubernetes_pod_name":"stable-cloud-log-flume-774c778c98-rw5ct","log_collect":"true","name":"source_from_kafka_sink","pod_template_hash":"774c778c98","prometheus":"middleware","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 cloud-prod-4 日志采集客户端 stable-cloud-log-flume-774c778c98-rw5ct 类型 SINK 名称 source_from_kafka_sink 2分钟内连续为0 0","key":"middleware.cloud-logs.flume_sink_drain_success","summary":"生产环境集群 cloud-prod-4 日志采集客户端 stable-cloud-log-flume-774c778c98-rw5ct 类型 SINK 名称 source_from_kafka_sink 事件接收异常","trigger":"0"},"state":"FIRING","activeAt":"2021-01-29T07:53:41.528077126Z","value":"0e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"Flume消费端Sink DrainSuccess Count","app":"cloud-log-flume","app_image_version":"v0.5","app_instance":"stable","app_kubernetes_io_name":"cloud-logs","cloud_cluster":"cloud-prod-4","host":"localhost:41414","instance":"10.58.0.226:9360","job":"kubernetes-pods","kubernetes_namespace":"cloud-logs","kubernetes_pod_name":"stable-cloud-log-flume-774c778c98-rw5ct","log_collect":"true","name":"avro_sink","pod_template_hash":"774c778c98","prometheus":"middleware","type":"middleware.cloud-logs"},"annotations":{"description":"生产环境集群 cloud-prod-4 日志采集客户端 stable-cloud-log-flume-774c778c98-rw5ct 类型 SINK 名称 avro_sink 2分钟内连续为0 0","key":"middleware.cloud-logs.flume_sink_drain_success","summary":"生产环境集群 cloud-prod-4 日志采集客户端 stable-cloud-log-flume-774c778c98-rw5ct 类型 SINK 名称 avro_sink 事件接收异常","trigger":"0"},"state":"PENDING","activeAt":"2021-04-13T09:55:11.528077126Z","value":"0e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.023500167,"lastEvaluation":"2021-04-13T18:09:13.93567832+08:00","type":"alerting"},{"state":"INACTIVE","name":"Flume消费端Source Received Count(测试环境)","query":"abs(delta(FLUME_SOURCE_EventReceivedCount{cloud_cluster=~\"cloud-sit.*\"}[1d])) == 0 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 23","duration":300,"labels":{"alertname":"Flume消费端Source Received Count(测试环境)","type":"middleware.cloud-logs"},"annotations":{"description":"测试环境集群 {{ $labels.cloud_cluster }} 日志采集客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 24小时内连续为0 {{ $value }}","key":"middleware.cloud-logs.flume_srouce_received.sit","summary":"生产环境集群 {{ $labels.cloud_cluster }} Flume客户端 {{ $labels.kubernetes_pod_name }} 类型 {{ $labels.type }} 名称 {{ $labels.name }} 事件接收异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.264053645,"lastEvaluation":"2021-04-13T18:09:13.295952348+08:00","type":"alerting"},{"state":"FIRING","name":"日志Kafka集群消息消费延迟","query":"sum by(consumergroup, topic) (kafka_consumergroup_lag{kubernetes_namespace=\"cloud-logs\"}) \u003e 20000","duration":300,"labels":{"alertname":"日志Kafka集群消息消费延迟","type":"middleware.cloud-logs"},"annotations":{"description":"日志Kafka集群队列{{ $labels.topic }}消费延迟大于2w条，当前滞后 {{ $value }} 条","key":"middleware.cloud-logs.kafka.lag","summary":"日志Kafka集群队列{{ $labels.topic }}消费延迟大于2w条","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"日志Kafka集群消息消费延迟","consumergroup":"datasource","topic":"138-logstash-audit-.logs","type":"middleware.cloud-logs"},"annotations":{"description":"日志Kafka集群队列138-logstash-audit-.logs消费延迟大于2w条，当前滞后 87981 条","key":"middleware.cloud-logs.kafka.lag","summary":"日志Kafka集群队列138-logstash-audit-.logs消费延迟大于2w条","trigger":"87981"},"state":"FIRING","activeAt":"2021-04-13T09:24:41.528077126Z","value":"8.7981e+04","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"日志Kafka集群消息消费延迟","consumergroup":"datasource","topic":"uit-logstash-audit-.logs","type":"middleware.cloud-logs"},"annotations":{"description":"日志Kafka集群队列uit-logstash-audit-.logs消费延迟大于2w条，当前滞后 167455 条","key":"middleware.cloud-logs.kafka.lag","summary":"日志Kafka集群队列uit-logstash-audit-.logs消费延迟大于2w条","trigger":"167455"},"state":"FIRING","activeAt":"2021-04-13T09:18:41.528077126Z","value":"1.67455e+05","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.104870081,"lastEvaluation":"2021-04-13T18:09:13.959182859+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"middleware.elasticsearch","file":"/thanos-prometheus/config/rules/middleware/elasticsearch.rules","rules":[{"state":"FIRING","name":"elasticsearch健康检查","query":"elasticsearch_cluster_health_up != 1","duration":300,"labels":{"alertname":"elasticsearch健康检查","type":"middleware.elasticsearch"},"annotations":{"description":"elasticsearch {{ $labels.instance }} 状态异常,所在app {{ $labels.app }},所在集群 {{ $labels.cloud_cluster }}","key":"middleware.elasticsearch.health","summary":"elasticsearch {{ $labels.instance }} 状态异常","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"elasticsearch健康检查","app":"smartvoice-elasticsearch-exporter","cloud_cluster":"cloud-sit-2","instance":"10.244.13.219:9114","job":"kubernetes-pods","kubernetes_namespace":"smartvoice-cloudpepper-v3-fit","kubernetes_pod_name":"smartvoice-elasticsearch-exporter-697465cf5c-c9g42","pod_template_hash":"697465cf5c","prometheus":"middleware","type":"middleware.elasticsearch"},"annotations":{"description":"elasticsearch 10.244.13.219:9114 状态异常,所在app smartvoice-elasticsearch-exporter,所在集群 cloud-sit-2","key":"middleware.elasticsearch.health","summary":"elasticsearch 10.244.13.219:9114 状态异常","trigger":"0"},"state":"FIRING","activeAt":"2021-03-22T08:37:01.679566352Z","value":"0e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.004433234,"lastEvaluation":"2021-04-13T18:09:01.679864443+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"middleware.loadbalance","file":"/thanos-prometheus/config/rules/middleware/loadbalance.rules","rules":[{"state":"INACTIVE","name":"四层负载均衡器Keepalived进程","query":"keepalived_process_state{job=\"node-exporter\"} \u003c 1","duration":60,"labels":{"alertname":"四层负载均衡器Keepalived进程","type":"middleware.loadbalance"},"annotations":{"description":"主机 {{ $labels.instance }}主机组{{ $labels.host_group}}Keepalived进程中断,状态{{ $value }},预期0","key":"middleware.loadbalance.process_state","summary":"主机 {{ $labels.instance }}主机组{{ $labels.host_group}}Keepalived进程中断","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.00299667,"lastEvaluation":"2021-04-13T18:09:07.390902625+08:00","type":"alerting"},{"state":"INACTIVE","name":"四层负载均衡器Virtual IP 状态检查","query":"sum(keepalived_vip_state{vip=\"10.51.1.232\"}) \u003c 0.9 or sum(keepalived_vip_state{vip=\"10.51.1.231\"}) \u003c 0.9 or sum(keepalived_vip_state{host_group=\"cloud-prod-3\",vip=\"10.51.3.231\"}) \u003c 0.9 or sum(keepalived_vip_state{host_group=\"cloud-prod-3\",vip=\"10.51.3.232\"}) \u003c 0.9 or sum(keepalived_vip_state{host_group=\"cloud-sit-2\",vip=\"10.155.254.137\"}) \u003c 0.9","duration":60,"labels":{"alertname":"四层负载均衡器Virtual IP 状态检查","type":"middleware.loadbalance"},"annotations":{"description":"负载均衡器VIP {{ $labels.vip }}状态异常,,状态{{ $value }},预期1","key":"middleware.loadbalance.virtual_ip","summary":"负载均衡器VIP {{ $labels.vip }}状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.04910323,"lastEvaluation":"2021-04-13T18:09:07.395990491+08:00","type":"alerting"},{"state":"INACTIVE","name":"四层负载均衡器端口渲染错误","query":"consul_template_state{host_group=\"load-balance\"} == 0","duration":0,"labels":{"alertname":"四层负载均衡器端口渲染错误","type":"middleware.loadbalance"},"annotations":{"description":"负载均衡器 {{ $labels.instance}} 端口渲染错误,状态{{ $value }},预期1","key":"middleware.loadbalance.consul","summary":"负载均衡器 {{ $labels.instance}} 端口渲染错误","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003021972,"lastEvaluation":"2021-04-13T18:09:07.387873993+08:00","type":"alerting"},{"state":"INACTIVE","name":"四层负载均衡器语法错误","query":"nginx_configuration_syntax{host_group=\"load-balance\"} == 0","duration":0,"labels":{"alertname":"四层负载均衡器语法错误","type":"middleware.loadbalance"},"annotations":{"description":"负载均衡器{{ $labels.instance}}语法错误,,状态{{ $value }},预期1","key":"middleware.loadbalance.syntax","summary":"负载均衡器{{ $labels.instance}}语法错误","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002084949,"lastEvaluation":"2021-04-13T18:09:07.39390234+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"middleware.mongodb.rules","file":"/thanos-prometheus/config/rules/middleware/mongodb.rules","rules":[{"state":"INACTIVE","name":"mongodb1分钟操作","query":"rate(mongodb_mongod_op_counters_total{cloud_cluster=~\"cloud-prod-.*\"}[1m]) \u003e 1000","duration":60,"labels":{"alertname":"mongodb1分钟操作","type":"middleware.mongodb"},"annotations":{"description":"mongoDB 1分钟操作过高。集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mongodb.ops","summary":"mongoDB 1分钟操作过高。集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.037768474,"lastEvaluation":"2021-04-13T18:09:11.458823222+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb1分钟网络流量","query":"rate(mongodb_mongod_network_bytes_total{cloud_cluster=~\"cloud-prod-.*\"}[1m]) / 1024 / 1024 \u003e 512","duration":60,"labels":{"alertname":"mongodb1分钟网络流量","type":"middleware.mongodb"},"annotations":{"description":"mongoDB 1分钟网络流量超限。集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}\n","key":"middleware.mongodb.net","summary":"mongoDB 1分钟网络流量超限。集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.014111427,"lastEvaluation":"2021-04-13T18:09:11.555080041+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb全局锁","query":"mongodb_mongod_global_lock_ratio{cloud_cluster=~\"cloud-prod-.*\"} != 0 or mongodb_mongod_global_lock_current_queue{cloud_cluster=~\"cloud-prod-.*\"} != 0 or mongodb_mongod_global_lock_ratio{cloud_cluster=~\"cloud-prod-.*\"} != 0","duration":10,"labels":{"alertname":"mongodb全局锁","type":"middleware.mongodb"},"annotations":{"description":"mongoDB出现全局锁定，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mongodb.glock","summary":"mongoDB出现全局锁定，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.007352351,"lastEvaluation":"2021-04-13T18:09:11.499721506+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb内存使用率","query":"mongodb_mongod_wiredtiger_cache_bytes{type=\"total\"} / on(kubernetes_pod_name, app, cloud_cluster, component, instance) mongodb_mongod_wiredtiger_cache_max_bytes * 100 \u003e 80","duration":60,"labels":{"alertname":"mongodb内存使用率","type":"middleware.mongodb"},"annotations":{"description":"mongoDB内存使用率偏高，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前百分比{{$value}}","key":"middleware.mongodb.buffer","summary":"mongoDB内存使用率偏高，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.02535409,"lastEvaluation":"2021-04-13T18:09:11.529720693+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb可用事务ticket","query":"mongodb_mongod_wiredtiger_concurrent_transactions_available_tickets{cloud_cluster=~\"cloud-prod-.*\"} \u003c 10","duration":60,"labels":{"alertname":"mongodb可用事务ticket","type":"middleware.mongodb"},"annotations":{"description":"mongoDB可用ticket过少，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值{{$value}}","key":"middleware.mongodb.ticket","summary":"mongoDB可用ticket过少，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005819597,"lastEvaluation":"2021-04-13T18:09:11.397805134+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb可用连接","query":"mongodb_mongod_connections{cloud_cluster=~\"cloud-prod-.*\",state=\"available\"} \u003c 100","duration":60,"labels":{"alertname":"mongodb可用连接","type":"middleware.mongodb"},"annotations":{"description":"mongoDB可用连接过低，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mongodb.conns","summary":"mongoDB可用连接过低，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.00304962,"lastEvaluation":"2021-04-13T18:09:11.403628474+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb实例存活状态","query":"mongodb_up != 1","duration":1,"labels":{"alertname":"mongodb实例存活状态","type":"middleware.mongodb"},"annotations":{"description":"mongoDB实例异常终止，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mongodb.up","summary":"mongoDB实例异常终止，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.052135854,"lastEvaluation":"2021-04-13T18:09:11.406681524+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb数据库文件过大","query":"(mongodb_mongod_db_data_size_bytes{cloud_cluster=~\"cloud-prod-.*\"} + mongodb_mongod_db_index_size_bytes{cloud_cluster=~\"cloud-prod-.*\"}) / 1024 / 1024 / 1024 \u003e 60","duration":10,"labels":{"alertname":"mongodb数据库文件过大","type":"middleware.mongodb"},"annotations":{"description":"mongoDB数据库过大，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，db name{{$labels.db}}，当前值 {{ $value }}","key":"middleware.mongodb.dbsize","summary":"mongoDB数据库过大，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.022639879,"lastEvaluation":"2021-04-13T18:09:11.5070777+08:00","type":"alerting"},{"state":"INACTIVE","name":"mongodb短时间连接超限","query":"rate(mongodb_mongod_connections_metrics_created_total{cloud_cluster=~\"cloud-prod-.*\"}[1m]) \u003e 1000","duration":60,"labels":{"alertname":"mongodb短时间连接超限","type":"middleware.mongodb"},"annotations":{"description":"mongoDB 1分钟内连接次数超过1000，请关注短链接。\n集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mongodb.conn","summary":"mongoDB 1分钟内连接次数超过1000，请关注短链接。\n集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.00311576,"lastEvaluation":"2021-04-13T18:09:11.496602501+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"middleware.mysql","file":"/thanos-prometheus/config/rules/middleware/mysql.rules","rules":[{"state":"FIRING","name":"msql-slaveSql","query":"mysql_slave_status_slave_sql_running{cloud_cluster=~\"cloud-prod.*\"} != 1","duration":30,"labels":{"alertname":"msql-slaveSql","type":"middleware.mysql"},"annotations":{"description":"MYSQL 主从复制sql 线程失败，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.slavesql","summary":"MYSQL 主从复制失败,集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[{"labels":{"action":"big-data-sync","alertname":"msql-slaveSql","app":"slave-roc-mysql","cloud_cluster":"cloud-prod-1","controller_revision_hash":"slave-roc-mysql-6f485b8cbb","instance":"10.152.21.174:9104","job":"kubernetes-pods","kubernetes_namespace":"cloudpepper-v2-roc","kubernetes_pod_name":"slave-roc-mysql-0","master_host":"roc-mysql","prometheus":"middleware","statefulset_kubernetes_io_pod_name":"slave-roc-mysql-0","type":"middleware.mysql"},"annotations":{"description":"MYSQL 主从复制sql 线程失败，集群名称 cloud-prod-1 ，app名称 slave-roc-mysql-0，命名空间 cloudpepper-v2-roc，当前值 0","key":"middleware.mysql.slavesql","summary":"MYSQL 主从复制失败,集群名称 cloud-prod-1 ，app名称 slave-roc-mysql-0，命名空间 cloudpepper-v2-roc","trigger":"0"},"state":"FIRING","activeAt":"2021-04-11T01:06:06.660068326Z","value":"0e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.004510645,"lastEvaluation":"2021-04-13T18:09:06.737744645+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql 连接数存在跌零风险","query":"(mysql_info_schema_processes_by_user{cloud_cluster=~\"cloud-prod.*\"} offset 1m - mysql_info_schema_processes_by_user{cloud_cluster=~\"cloud-prod.*\"}) / mysql_info_schema_processes_by_user{cloud_cluster=~\"cloud-prod.*\"} offset 1m * 100 \u003e 90","duration":0,"labels":{"alertname":"mysql 连接数存在跌零风险","type":"middleware.mysql"},"annotations":{"description":"MYSQL连接数较1分钟前有较大变动，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，1分钟连接数差值 {{ $value }} %","key":"middleware.mysql.connection","summary":"MYSQL连接数较1分钟前有较大变动，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.020680459,"lastEvaluation":"2021-04-13T18:09:06.712872853+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-TableDefaultCache","query":"mysql_global_status_open_table_definitions{cloud_cluster=~\"cloud-prod.*\"} \u003e mysql_global_variables_table_definition_cache{cloud_cluster=~\"cloud-prod.*\"}","duration":0,"labels":{"alertname":"mysql-TableDefaultCache","type":"middleware.mysql"},"annotations":{"description":"MYSQL table_definition_cache 过小，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.definecache","summary":"MYSQL table_definition_cache 过小，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.006600312,"lastEvaluation":"2021-04-13T18:09:06.700469012+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-binlog状态","query":"mysql_global_variables_log_bin{cloud_cluster=~\"cloud-prod.*\"} != 1","duration":0,"labels":{"alertname":"mysql-binlog状态","type":"middleware.mysql"},"annotations":{"description":"MYSQL binlog 未开启，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.binlog","summary":"MYSQL binlog 未开启，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003996862,"lastEvaluation":"2021-04-13T18:09:06.696469171+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-readbuffer 过大","query":"mysql_global_variables_read_buffer_size{cloud_cluster=~\"cloud-prod.*\"} \u003e mysql_global_variables_slave_max_allowed_packet{cloud_cluster=~\"cloud-prod.*\"}","duration":60,"labels":{"alertname":"mysql-readbuffer 过大","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例read buffer 过大，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.readbuffer","summary":"MYSQL实例read buffer 过大，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005798276,"lastEvaluation":"2021-04-13T18:09:06.707072478+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-sortbuffer错误","query":"mysql_global_variables_innodb_sort_buffer_size{cloud_cluster=~\"cloud-prod.*\"} \u003c 256 * 1024 or mysql_global_variables_read_buffer_size{cloud_cluster=~\"cloud-prod.*\"} \u003e 4 * 1024 * 1024","duration":60,"labels":{"alertname":"mysql-sortbuffer错误","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例sort buffer 配置错误，过大或过小，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.sortbuffer","summary":"MYSQL实例sort buffer 配置错误，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.011478022,"lastEvaluation":"2021-04-13T18:09:06.684987031+08:00","type":"alerting"},{"state":"FIRING","name":"mysql-主从","query":"mysql_slave_status_slave_io_running != 1","duration":30,"labels":{"alertname":"mysql-主从","type":"middleware.mysql"},"annotations":{"description":"MYSQL主从同步失败，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.replication","summary":"MYSQL主从同步失败，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[{"labels":{"action":"big-data-sync","alertname":"mysql-主从","app":"slave-roc-mysql","cloud_cluster":"cloud-prod-1","controller_revision_hash":"slave-roc-mysql-6f485b8cbb","instance":"10.152.21.174:9104","job":"kubernetes-pods","kubernetes_namespace":"cloudpepper-v2-roc","kubernetes_pod_name":"slave-roc-mysql-0","master_host":"roc-mysql","prometheus":"middleware","statefulset_kubernetes_io_pod_name":"slave-roc-mysql-0","type":"middleware.mysql"},"annotations":{"description":"MYSQL主从同步失败，集群名称 cloud-prod-1 ，app名称 slave-roc-mysql-0，命名空间 cloudpepper-v2-roc，当前值 0","key":"middleware.mysql.replication","summary":"MYSQL主从同步失败，集群名称 cloud-prod-1 ，app名称 slave-roc-mysql-0，命名空间 cloudpepper-v2-roc","trigger":"0"},"state":"FIRING","activeAt":"2021-04-11T01:06:06.660068326Z","value":"0e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.004197502,"lastEvaluation":"2021-04-13T18:09:06.762288993+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-主从延迟","query":"rate(mysql_slave_status_seconds_behind_master{cloud_cluster=~\"cloud-prod.*\"}[1m]) \u003e 30","duration":30,"labels":{"alertname":"mysql-主从延迟","type":"middleware.mysql"},"annotations":{"description":"MYSQL主从同步延迟超过30s，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.slavedelay","summary":"MYSQL主从同步延迟，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003472558,"lastEvaluation":"2021-04-13T18:09:06.758813195+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-打开文件数","query":"mysql_global_status_innodb_num_open_files{cloud_cluster=~\"cloud-prod.*\"} \u003e (mysql_global_variables_open_files_limit{cloud_cluster=~\"cloud-prod.*\"}) * 0.75","duration":30,"labels":{"alertname":"mysql-打开文件数","type":"middleware.mysql"},"annotations":{"description":"MYSQL 实例打开文件数过多，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.openfiles","summary":"MYSQL 实例打开文件数过多，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.006159991,"lastEvaluation":"2021-04-13T18:09:06.752649995+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-探活","query":"mysql_up{cloud_cluster!=\"cloud-sit-1\"} == 0","duration":30,"labels":{"alertname":"mysql-探活","type":"middleware.mysql"},"annotations":{"description":"MYSQL 实例 is down，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.instance","summary":"MYSQL 实例 is down，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.004625116,"lastEvaluation":"2021-04-13T18:09:06.766491009+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql-连接数过高","query":"mysql_global_status_max_used_connections{cloud_cluster=~\"cloud-prod.*\"} \u003e mysql_global_variables_max_connections{cloud_cluster=~\"cloud-prod.*\"} * 0.8","duration":60,"labels":{"alertname":"mysql-连接数过高","type":"middleware.mysql"},"annotations":{"description":"MYSQL 实例连接数超过80%，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.connections","summary":"MYSQL实例连接数超过80%，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.006352431,"lastEvaluation":"2021-04-13T18:09:06.678632133+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql写入流量","query":"rate(mysql_global_status_bytes_received{cloud_cluster=~\"cloud-prod.*\"}[1m]) / 1024 / 1024 \u003e 10","duration":300,"labels":{"alertname":"mysql写入流量","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例写入流量异常,集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前{{ $value | printf \"%.2f\" }}MB/s","key":"middleware.mysql.received_traffic","summary":"MYSQL实例写入流量异常,集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.004185787,"lastEvaluation":"2021-04-13T18:09:06.733556796+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql发送流量","query":"rate(mysql_global_status_bytes_sent{cloud_cluster=~\"cloud-prod.*\"}[1m]) / 1024 / 1024 \u003e 20","duration":300,"labels":{"alertname":"mysql发送流量","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例发送流量异常, 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前{{ $value | printf \"%.2f\" }}MB/s","key":"middleware.mysql.send_traffic","summary":"MYSQL实例发送流量异常，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005208514,"lastEvaluation":"2021-04-13T18:09:06.77111927+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql实时qps","query":"irate(mysql_global_status_questions[1m]) \u003e 6000","duration":0,"labels":{"alertname":"mysql实时qps","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例QPS峰值预警，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value | printf \"%.2f\" }}","key":"middleware.mysql.qps","summary":"MYSQL实例QPS峰值预警，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.007905688,"lastEvaluation":"2021-04-13T18:09:06.660317976+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql慢查询","query":"mysql_global_status_slow_queries{cloud_cluster=~\"cloud-prod.*\"} - mysql_global_status_slow_queries{cloud_cluster=~\"cloud-prod.*\"} offset 1m \u003e 3","duration":0,"labels":{"alertname":"mysql慢查询","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例 出现慢查询, 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.slow_queries","summary":"MYSQL实例出现慢查询，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.01040009,"lastEvaluation":"2021-04-13T18:09:06.668227194+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql锁表等待","query":"mysql_global_status_table_locks_waited{cloud_cluster=~\"cloud-prod.*\"} - mysql_global_status_table_locks_waited{cloud_cluster=~\"cloud-prod.*\"} offset 1m \u003e 1","duration":0,"labels":{"alertname":"mysql锁表等待","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例锁表，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.table_lock_wait","summary":"MYSQL实例锁表，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.006430608,"lastEvaluation":"2021-04-13T18:09:06.746216125+08:00","type":"alerting"},{"state":"INACTIVE","name":"mysql阻塞连接","query":"mysql_global_status_locked_connects{cloud_cluster=~\"cloud-prod.*\"} \u003e 0","duration":0,"labels":{"alertname":"mysql阻塞连接","type":"middleware.mysql"},"annotations":{"description":"MYSQL实例连接连接阻塞,  集群名称 {{ $labels.cloud_cluster }} ，命名空间 {{ $labels.kubernetes_namespace }} ，pod名称 {{ $labels.kubernetes_pod_name}}，当前{{ $value }}","key":"middleware.mysql.connect_lock","summary":"MYSQL实例连接连接阻塞,  集群名称 {{ $labels.cloud_cluster }} ，命名空间 {{ $labels.kubernetes_namespace }} ，pod名称 {{ $labels.kubernetes_pod_name}}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003954515,"lastEvaluation":"2021-04-13T18:09:06.742259458+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"middleware.redis","file":"/thanos-prometheus/config/rules/middleware/redis.rules","rules":[{"state":"INACTIVE","name":"Redis CPU使用率","query":"rate(redis_cpu_user_seconds_total{cloud_cluster=~\"cloud-prod-.*\"}[1m]) + rate(redis_cpu_sys_seconds_total{cloud_cluster=~\"cloud-prod-.*\"}[1m]) \u003e 60","duration":60,"labels":{"alertname":"Redis CPU使用率","type":"middleware.redis"},"annotations":{"description":"Reids生产环境CPU过高 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value | printf \"%.2f\"  }}","key":"redis.cpu.usage","summary":"Reids生产环境 集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.kubernetes_namespace }} 容器 {{ $labels.kubernetes_pod_name }} 的CPU过高","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.009239257,"lastEvaluation":"2021-04-13T18:09:07.011176162+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis 主从同步延迟","query":"redis_master_last_io_seconds{cloud_cluster=~\"cloud-prod-.*\"} \u003e 10","duration":30,"labels":{"alertname":"Redis 主从同步延迟","type":"middleware.redis"},"annotations":{"description":"redis 主从同步延迟告警，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.redis_master_last_io","summary":"redis 主从同步延迟告警，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002770687,"lastEvaluation":"2021-04-13T18:09:07.03032627+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis 执行rdb时间过长","query":"redis_rdb_bgsave_in_progress{cloud_cluster=~\"cloud-prod-.*\"} == 0 and redis_rdb_current_bgsave_duration_sec{cloud_cluster=~\"cloud-prod-.*\"} \u003e 2","duration":1,"labels":{"alertname":"Redis 执行rdb时间过长","type":"middleware.redis"},"annotations":{"description":"redis 执行rdb 时间过长，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.rdblong","summary":"redis {{ $labels.instance }} 执行rdb时间过长","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.008946699,"lastEvaluation":"2021-04-13T18:09:07.002225926+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis健康检查","query":"redis_up != 1","duration":300,"labels":{"alertname":"Redis健康检查","type":"middleware.redis"},"annotations":{"description":"redis 未启动或已宕机，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.mysql.health","summary":"redis {{ $labels.instance }} 状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.006489901,"lastEvaluation":"2021-04-13T18:09:06.929447713+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis内存使用超限","query":"redis_memory_used_bytes{cloud_cluster=~\"cloud-prod-.*\"} / redis_total_system_memory_bytes{cloud_cluster=~\"cloud-prod-.*\"} * 100 \u003e 90","duration":10,"labels":{"alertname":"Redis内存使用超限","type":"middleware.redis"},"annotations":{"description":"redis 内存使用率过高，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.health","summary":"redis {{ $labels.instance }} 内存使用状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005647024,"lastEvaluation":"2021-04-13T18:09:07.080876684+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis内存碎片率过高","query":"redis_mem_fragmentation_ratio{cloud_cluster=~\"cloud-prod-.*\"} \u003e 10","duration":0,"labels":{"alertname":"Redis内存碎片率过高","type":"middleware.redis"},"annotations":{"description":"redis 内存碎片过高，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.frag","summary":"redis 内存碎片过高，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.008020731,"lastEvaluation":"2021-04-13T18:09:06.921423558+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis命中率过低","query":"redis_keyspace_hits_total{cloud_cluster=~\"cloud-prod-.*\"} / (redis_keyspace_hits_total{cloud_cluster=~\"cloud-prod-.*\"} + redis_keyspace_misses_total{cloud_cluster=~\"cloud-prod-.*\"}) \u003c 0","duration":0,"labels":{"alertname":"Redis命中率过低","type":"middleware.redis"},"annotations":{"description":"redis 命中率过低，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.hit","summary":"redis 命中率过低，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.012515133,"lastEvaluation":"2021-04-13T18:09:07.056193949+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis慢查询","query":"redis_last_slow_execution_duration_seconds{cloud_cluster=~\"cloud-prod-.*\"} \u003e 1","duration":60,"labels":{"alertname":"Redis慢查询","type":"middleware.redis"},"annotations":{"description":"Reids生产环境出现慢查询, 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"redis.slowquery","summary":"Reids生产环境 集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.kubernetes_namespace }} 容器 {{ $labels.kubernetes_pod_name }} 出现慢查询","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005512169,"lastEvaluation":"2021-04-13T18:09:06.9967106+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis执行时间陡增","query":"rate(redis_commands_duration_seconds_total{cloud_cluster=~\"cloud-prod-.*\"}[10s]) \u003e 0.2","duration":10,"labels":{"alertname":"Redis执行时间陡增","type":"middleware.redis"},"annotations":{"description":"10s内命令的执行时间陡增，集群名称 {{ $labels.cloud_cluster }} ，pod名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.commtime","summary":"10s内命令的执行时间陡增,集群名称 {{ $labels.cloud_cluster }} ，pod名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.023091259,"lastEvaluation":"2021-04-13T18:09:07.03309907+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis短时新增过多","query":"rate(redis_connected_clients{cloud_cluster=~\"cloud-prod-.*\"}[1m]) \u003e 20","duration":0,"labels":{"alertname":"Redis短时新增过多","type":"middleware.redis"},"annotations":{"description":"redis 短时连接过多，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.connects","summary":"redis 短时连接过多，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.060765966,"lastEvaluation":"2021-04-13T18:09:06.935941174+08:00","type":"alerting"},{"state":"INACTIVE","name":"Redis连接拒绝","query":"increase(redis_rejected_connections_total{cloud_cluster=~\"cloud-prod-.*\"}[1m]) \u003e 0","duration":10,"labels":{"alertname":"Redis连接拒绝","type":"middleware.redis"},"annotations":{"description":"redis 出现连接拒绝，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.reject","summary":"redis {{ $labels.instance }}发生连接拒绝","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.004582443,"lastEvaluation":"2021-04-13T18:09:07.068712326+08:00","type":"alerting"},{"state":"FIRING","name":"Redis连接数异常","query":"redis_connected_clients{cloud_cluster=~\"cloud-prod-.*\"} \u003e 1000","duration":60,"labels":{"alertname":"Redis连接数异常","type":"middleware.redis"},"annotations":{"description":"redis 连接数异常，集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value }}","key":"middleware.redis.connections","summary":"redis {{ $labels.instance }} 连接数过高","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"Redis连接数异常","app":"smartvoice-redis-exporter","cloud_cluster":"cloud-prod-1","instance":"10.152.26.10:9121","job":"kubernetes-pods","kubernetes_namespace":"smartvoice-iv-v2","kubernetes_pod_name":"smartvoice-redis-exporter-6b98c5d8d6-9hstg","pod_template_hash":"2654718482","prometheus":"middleware","type":"middleware.redis"},"annotations":{"description":"redis 连接数异常，集群名称 cloud-prod-1 ，app名称 smartvoice-redis-exporter-6b98c5d8d6-9hstg，命名空间 smartvoice-iv-v2，当前值 5008","key":"middleware.redis.connections","summary":"redis 10.152.26.10:9121 连接数过高","trigger":"5008"},"state":"FIRING","activeAt":"2021-04-11T07:28:06.91527966Z","value":"5.008e+03","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.010509006,"lastEvaluation":"2021-04-13T18:09:07.086526797+08:00","type":"alerting"},{"state":"INACTIVE","name":"redis aof 刷盘延迟","query":"redis_aof_delayed_fsync{cloud_cluster=~\"cloud-prod-.*\"} - redis_aof_delayed_fsync{cloud_cluster=~\"cloud-prod-.*\"} offset 1s \u003e 0","duration":5,"labels":{"alertname":"redis aof 刷盘延迟","type":"middleware.redis"},"annotations":{"description":"Reids aof 写盘出现延迟，可能造成redi实例阻塞。 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value | printf \"%.2f\"  }}","key":"redis.aof.delay","summary":"Reids aof 写盘延迟。集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.kubernetes_namespace }} 容器 {{ $labels.kubernetes_pod_name }} ","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005146258,"lastEvaluation":"2021-04-13T18:09:07.020418775+08:00","type":"alerting"},{"state":"INACTIVE","name":"redis rdb写盘失败","query":"redis_rdb_last_bgsave_status{cloud_cluster=~\"cloud-prod-.*\"} == 0","duration":5,"labels":{"alertname":"redis rdb写盘失败","type":"middleware.redis"},"annotations":{"description":"Reids rdb写盘失败， 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value | printf \"%.2f\"  }}\n","key":"redis.rdb.error","summary":"Reids生产环境 集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.kubernetes_namespace }} 容器 {{ $labels.kubernetes_pod_name }} rdb写盘失败","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.005974106,"lastEvaluation":"2021-04-13T18:09:06.915446032+08:00","type":"alerting"},{"state":"INACTIVE","name":"redis 主从同步失败","query":"redis_master_link_up{cloud_cluster=~\"cloud-prod-.*\"} != 1","duration":1,"labels":{"alertname":"redis 主从同步失败","type":"middleware.redis"},"annotations":{"description":"Reids 主从同步失败， 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value | printf \"%.2f\"  }}\n","key":"redis.replicat.error","summary":"Reids生产环境 集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.kubernetes_namespace }} 容器 {{ $labels.kubernetes_pod_name }} 主从同步失败","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.007575557,"lastEvaluation":"2021-04-13T18:09:07.073297749+08:00","type":"alerting"},{"state":"INACTIVE","name":"redis 写 aof 失败","query":"redis_aof_last_write_status{cloud_cluster=~\"cloud-prod-.*\"} == 0","duration":5,"labels":{"alertname":"redis 写 aof 失败","type":"middleware.redis"},"annotations":{"description":"Reids 写aof 失败。 集群名称 {{ $labels.cloud_cluster }} ，app名称 {{ $labels.kubernetes_pod_name }}，命名空间 {{ $labels.kubernetes_namespace }}，当前值 {{ $value | printf \"%.2f\"  }}\n","key":"redis.aof.writerror","summary":"Reids生产环境 集群 {{ $labels.cloud_cluster }} 命名空间 {{ $labels.kubernetes_namespace }} 容器 {{ $labels.kubernetes_pod_name }} 写aof失败，检查redis主线程阻塞。","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.00475504,"lastEvaluation":"2021-04-13T18:09:07.025567744+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"nodes.base","file":"/thanos-prometheus/config/rules/nodes/base.rules","rules":[{"state":"INACTIVE","name":"CPU_IOWait使用率","query":"avg by(instance, host_group) (rate(node_cpu_seconds_total{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",mode=\"iowait\"}[2m])) * 100 \u003e 40","duration":60,"labels":{"alertname":"CPU_IOWait使用率","type":"nodes.base"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} CPU_ioWait预警,当前{{ $value | printf \"%.2f\" }}","key":"nodes.base.cpu_rate.iowait","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} CPU_ioWait预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.210492714,"lastEvaluation":"2021-04-13T18:09:05.328898337+08:00","type":"alerting"},{"state":"INACTIVE","name":"CPU使用率","query":"avg by(instance, host_group) (rate(node_cpu_seconds_total{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",mode=\"idle\"}[5m])) * 100 \u003c 20","duration":300,"labels":{"alertname":"CPU使用率","type":"nodes.base"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} CPU_idle预警,当前{{ $value | printf \"%.2f\" }}","key":"nodes.base.cpu_rate","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} CPU_idle预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.204562462,"lastEvaluation":"2021-04-13T18:09:05.539395096+08:00","type":"alerting"},{"state":"INACTIVE","name":"CPU温度","query":"avg(node_hwmon_temp_celsius{host_group!~\"|develop.*|unknown.*|Training.*\",job=~\"node-exporter\"}) \u003e 60","duration":900,"labels":{"alertname":"CPU温度","type":"nodes.base"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 硬件温度过高.当前温度{{ $value | printf \"%.2f\" }}度","key":"nodes.base.cpu_temp","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 硬件温度过高","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.092742269,"lastEvaluation":"2021-04-13T18:09:05.74396539+08:00","type":"alerting"},{"state":"INACTIVE","name":"CPU负载","query":"node_load1{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"} \u003e 50","duration":300,"labels":{"alertname":"CPU负载","type":"nodes.base"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 负载预警,当前{{ $value | printf \"%.2f\" }}","key":"nodes.base.node_load_lower","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 负载预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.011427022,"lastEvaluation":"2021-04-13T18:09:05.298190258+08:00","type":"alerting"},{"state":"FIRING","name":"主机存活","query":"up{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"} == 0","duration":60,"labels":{"alertname":"主机存活","type":"nodes.base"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 失联或者node—exporter故障,状态{{ $value }}","key":"nodes.base.health","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 失联或者node_exporter故障","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"主机存活","cloud_cluster":"cloud-bj-center","host_group":"bigdata","instance":"172.16.23.141","job":"node-exporter","prometheus":"standard","type":"nodes.base"},"annotations":{"description":"主机 172.16.23.141 主机组 bigdata 失联或者node—exporter故障,状态0","key":"nodes.base.health","summary":"主机 172.16.23.141 主机组 bigdata 失联或者node_exporter故障","trigger":"0"},"state":"FIRING","activeAt":"2020-08-19T10:39:35.297846533Z","value":"0e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"主机存活","cloud_cluster":"cloud-bj-center","host_group":"bigdata","instance":"172.16.23.134","job":"node-exporter","prometheus":"standard","type":"nodes.base"},"annotations":{"description":"主机 172.16.23.134 主机组 bigdata 失联或者node—exporter故障,状态0","key":"nodes.base.health","summary":"主机 172.16.23.134 主机组 bigdata 失联或者node_exporter故障","trigger":"0"},"state":"FIRING","activeAt":"2020-09-01T02:33:35.297846533Z","value":"0e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"主机存活","cloud_cluster":"cloud-bj-center","host_group":"bigdata","instance":"172.16.23.144","job":"node-exporter","prometheus":"standard","type":"nodes.base"},"annotations":{"description":"主机 172.16.23.144 主机组 bigdata 失联或者node—exporter故障,状态0","key":"nodes.base.health","summary":"主机 172.16.23.144 主机组 bigdata 失联或者node_exporter故障","trigger":"0"},"state":"FIRING","activeAt":"2020-10-28T09:34:35.297846533Z","value":"0e+00","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"主机存活","cloud_cluster":"cloud-bj-center","host_group":"bigdata","instance":"172.16.23.140","job":"node-exporter","prometheus":"standard","type":"nodes.base"},"annotations":{"description":"主机 172.16.23.140 主机组 bigdata 失联或者node—exporter故障,状态0","key":"nodes.base.health","summary":"主机 172.16.23.140 主机组 bigdata 失联或者node_exporter故障","trigger":"0"},"state":"FIRING","activeAt":"2020-09-18T10:04:05.297846533Z","value":"0e+00","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.019267333,"lastEvaluation":"2021-04-13T18:09:05.309624064+08:00","type":"alerting"},{"state":"INACTIVE","name":"内存使用率","query":"(node_memory_MemAvailable_bytes{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"} / node_memory_MemTotal_bytes{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}) * 100 \u003c 10","duration":600,"labels":{"alertname":"内存使用率","type":"nodes.base"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 内存空闲率预警,当前{{ $value | printf \"%.2f\" }}%","key":"nodes.base.memory_rate","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 内存空闲率预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.01849484,"lastEvaluation":"2021-04-13T18:09:05.850229466+08:00","type":"alerting"},{"state":"INACTIVE","name":"内存分配系统空间","query":"sum by(cloud_cluster, instance) (container_memory_rss{cloud_cluster=~\"cloud.*\",host_group!~\"|develop.*|unknown.*|Training.*\",id=\"/system.slice\",pod_name=\"\"}) / 1024 / 1024 / 1024 \u003e 60 or sum by(cloud_cluster, instance) (container_memory_rss{cloud_cluster=~\"cloud.*\",host_group!~\"|develop.*|unknown.*|Training.*\",id=~\"/system.slice/.*.service\"}) / 1024 / 1024 / 1024 \u003e 60","duration":3600,"labels":{"alertname":"内存分配系统空间","type":"nodes.base"},"annotations":{"description":"集群 {{ $labels.cloud_cluster }} 主机 {{ $labels.instance}} CGroup系统空间异常,当前{{ $value | printf \"%.2f\" }}GB","key":"nodes.base.memory_system_slice","summary":"集群 {{ $labels.cloud_cluster }} 主机 {{ $labels.instance}} CGroup系统空间异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.013512241,"lastEvaluation":"2021-04-13T18:09:05.8367128+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"nodes.disk","file":"/thanos-prometheus/config/rules/nodes/disk.rules","rules":[{"state":"FIRING","name":"主机磁盘写入速率异常","query":"sum by(instance, host_group) (irate(node_disk_written_bytes_total{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[2m])) / 1024 / 1024 \u003e 160","duration":300,"labels":{"alertname":"主机磁盘写入速率异常","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 磁盘写入速率异常,当前{{ $value | printf \"%.2f\" }}MB/s","key":"nodes.disk.write_rate_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 磁盘写入速率异常","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"主机磁盘写入速率异常","host_group":"glusterfs-prod","instance":"172.16.31.19","type":"nodes.disk"},"annotations":{"description":"主机 172.16.31.19 主机组 glusterfs-prod 磁盘写入速率异常,当前1156.92MB/s","key":"nodes.disk.write_rate_warning","summary":"主机 172.16.31.19 主机组 glusterfs-prod 磁盘写入速率异常","trigger":"1156.923105818341"},"state":"FIRING","activeAt":"2021-03-15T17:54:43.659285132Z","value":"1.156923105818341e+03","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"主机磁盘写入速率异常","host_group":"glusterfs-prod","instance":"172.16.31.22","type":"nodes.disk"},"annotations":{"description":"主机 172.16.31.22 主机组 glusterfs-prod 磁盘写入速率异常,当前390.08MB/s","key":"nodes.disk.write_rate_warning","summary":"主机 172.16.31.22 主机组 glusterfs-prod 磁盘写入速率异常","trigger":"390.081852213542"},"state":"FIRING","activeAt":"2021-04-06T15:45:43.659285132Z","value":"3.90081852213542e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"主机磁盘写入速率异常","host_group":"glusterfs-prod","instance":"172.16.31.20","type":"nodes.disk"},"annotations":{"description":"主机 172.16.31.20 主机组 glusterfs-prod 磁盘写入速率异常,当前1119.89MB/s","key":"nodes.disk.write_rate_warning","summary":"主机 172.16.31.20 主机组 glusterfs-prod 磁盘写入速率异常","trigger":"1119.8889225660803"},"state":"FIRING","activeAt":"2021-02-08T20:38:13.659285132Z","value":"1.1198889225660803e+03","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"主机磁盘写入速率异常","host_group":"glusterfs-prod","instance":"172.16.31.21","type":"nodes.disk"},"annotations":{"description":"主机 172.16.31.21 主机组 glusterfs-prod 磁盘写入速率异常,当前1043.87MB/s","key":"nodes.disk.write_rate_warning","summary":"主机 172.16.31.21 主机组 glusterfs-prod 磁盘写入速率异常","trigger":"1043.8674153645782"},"state":"FIRING","activeAt":"2021-04-06T14:30:13.659285132Z","value":"1.0438674153645782e+03","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.828419833,"lastEvaluation":"2021-04-13T18:09:14.56177737+08:00","type":"alerting"},{"state":"INACTIVE","name":"主机磁盘读取速率异常","query":"sum by(instance, host_group) (irate(node_disk_read_bytes_total{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[2m])) / 1024 / 1024 \u003e 80","duration":300,"labels":{"alertname":"主机磁盘读取速率异常","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 磁盘读取速率异常,当前{{ $value | printf \"%.2f\" }}MB/s","key":"nodes.disk.read_rate_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 磁盘读取速率异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.744402255,"lastEvaluation":"2021-04-13T18:09:15.486135974+08:00","type":"alerting"},{"state":"FIRING","name":"分区使用率","query":"100 - node_filesystem_avail_bytes{fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|udev|none|devpts|sysfs|debugfs|fuse.*\",host_group!~\"ceph\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",mountpoint!~\"/var/lib/(kubelet|heketi)/.*\"} / node_filesystem_size_bytes{fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|udev|none|devpts|sysfs|debugfs|fuse.*\",host_group!~\"ceph\",host_group!~\"develop.*|unknown-.*|Training-.*\",job=\"node-exporter\",mountpoint!~\"/var/lib/(kubelet|heketi)/.*\"} * 100 \u003e 85","duration":43200,"labels":{"alertname":"分区使用率","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 使用率预警,当前 {{ $value | printf \"%.2f\" }}%","key":"nodes.disk.filesystem_rate","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备{{ $labels.device }} 使用率预警","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/sdb1","fstype":"xfs","host_group":"bigdata","instance":"172.16.23.37","job":"node-exporter","mountpoint":"/data/disk0","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.37 主机组 bigdata 设备 /dev/sdb1 使用率预警,当前 99.74%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.37 主机组 bigdata 设备/dev/sdb1 使用率预警","trigger":"99.73991571416823"},"state":"FIRING","activeAt":"2020-11-22T03:57:13.659285132Z","value":"9.973991571416823e+01","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/sdc1","fstype":"xfs","host_group":"bigdata","instance":"172.16.23.39","job":"node-exporter","mountpoint":"/data/disk1","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.39 主机组 bigdata 设备 /dev/sdc1 使用率预警,当前 99.73%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.39 主机组 bigdata 设备/dev/sdc1 使用率预警","trigger":"99.72527683185623"},"state":"FIRING","activeAt":"2021-02-23T11:24:13.659285132Z","value":"9.972527683185623e+01","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/sdb1","fstype":"xfs","host_group":"bigdata","instance":"172.16.23.39","job":"node-exporter","mountpoint":"/data/disk0","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.39 主机组 bigdata 设备 /dev/sdb1 使用率预警,当前 98.71%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.39 主机组 bigdata 设备/dev/sdb1 使用率预警","trigger":"98.70783998743984"},"state":"FIRING","activeAt":"2021-02-27T05:29:43.659285132Z","value":"9.870783998743984e+01","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/sdc1","fstype":"xfs","host_group":"bigdata","instance":"172.16.23.38","job":"node-exporter","mountpoint":"/data/disk1","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.38 主机组 bigdata 设备 /dev/sdc1 使用率预警,当前 93.55%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.38 主机组 bigdata 设备/dev/sdc1 使用率预警","trigger":"93.55487852682687"},"state":"FIRING","activeAt":"2021-03-21T05:31:43.659285132Z","value":"9.355487852682687e+01","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/mapper/centos-home","fstype":"ext4","host_group":"bigdata","instance":"172.16.23.1","job":"node-exporter","mountpoint":"/home","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.1 主机组 bigdata 设备 /dev/mapper/centos-home 使用率预警,当前 85.48%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.1 主机组 bigdata 设备/dev/mapper/centos-home 使用率预警","trigger":"85.4834857967626"},"state":"FIRING","activeAt":"2020-11-22T03:57:13.659285132Z","value":"8.54834857967626e+01","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/sdc1","fstype":"xfs","host_group":"bigdata","instance":"172.16.23.37","job":"node-exporter","mountpoint":"/data/disk1","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.37 主机组 bigdata 设备 /dev/sdc1 使用率预警,当前 99.74%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.37 主机组 bigdata 设备/dev/sdc1 使用率预警","trigger":"99.7372393565347"},"state":"FIRING","activeAt":"2020-11-22T03:57:13.659285132Z","value":"9.97372393565347e+01","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/mapper/centos_dn1-opt","fstype":"ext4","host_group":"bigdata","instance":"172.16.23.2","job":"node-exporter","mountpoint":"/opt","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.2 主机组 bigdata 设备 /dev/mapper/centos_dn1-opt 使用率预警,当前 100.00%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.2 主机组 bigdata 设备/dev/mapper/centos_dn1-opt 使用率预警","trigger":"100"},"state":"FIRING","activeAt":"2021-03-13T22:13:43.659285132Z","value":"1e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"分区使用率","cloud_cluster":"cloud-bj-center","device":"/dev/sdb1","fstype":"xfs","host_group":"bigdata","instance":"172.16.23.38","job":"node-exporter","mountpoint":"/data/disk0","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.38 主机组 bigdata 设备 /dev/sdb1 使用率预警,当前 94.37%","key":"nodes.disk.filesystem_rate","summary":"主机 172.16.23.38 主机组 bigdata 设备/dev/sdb1 使用率预警","trigger":"94.36616381511065"},"state":"FIRING","activeAt":"2021-03-19T02:25:43.659285132Z","value":"9.436616381511065e+01","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.125011845,"lastEvaluation":"2021-04-13T18:09:13.659533832+08:00","type":"alerting"},{"state":"PENDING","name":"服务器分区未来48小时满额预测","query":"predict_linear(node_filesystem_free_bytes{fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|udev|none|devpts|sysfs|debugfs|fuse.*\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",mountpoint!~\"/var/lib/(kubelet|heketi)/.*\"}[2h], 48 * 3600) \u003c 0","duration":43200,"labels":{"alertname":"服务器分区未来48小时满额预测","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 未来24小时满额预警,当前{{ $value | printf \"%.2f\" }}%","key":"nodes.disk.filesystem_predict_linear_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 未来24小时满额预警","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"服务器分区未来48小时满额预测","cloud_cluster":"cloud-bj-center","device":"/dev/sdb1","fstype":"xfs","host_group":"bigdata","instance":"172.16.23.39","job":"node-exporter","mountpoint":"/data/disk0","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.39 主机组 bigdata 设备 /dev/sdb1 未来24小时满额预警,当前-89311659074.01%","key":"nodes.disk.filesystem_predict_linear_warning","summary":"主机 172.16.23.39 主机组 bigdata 设备 /dev/sdb1 未来24小时满额预警","trigger":"-8.931165907401337e+10"},"state":"PENDING","activeAt":"2021-04-13T02:47:13.659285132Z","value":"-8.931165907401337e+10","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.129665286,"lastEvaluation":"2021-04-13T18:09:14.068284448+08:00","type":"alerting"},{"state":"INACTIVE","name":"磁盘IO耗时异常","query":"irate(node_disk_io_time_seconds_total{device=~\"sd[a-z]\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m]) \u003e 10","duration":300,"labels":{"alertname":"磁盘IO耗时异常","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘IO耗时异常,当前{{ $value }}s","key":"nodes.disk.io_time_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘IO耗时异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.099018666,"lastEvaluation":"2021-04-13T18:09:14.46275447+08:00","type":"alerting"},{"state":"PENDING","name":"磁盘写入IOPS异常","query":"irate(node_disk_writes_completed_total{device=~\"sd[a-z]\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m]) \u003e 1000","duration":300,"labels":{"alertname":"磁盘写入IOPS异常","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘写入IOPS异常,当前{{ $value }}","key":"nodes.disk.write_iops_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘写入IOPS耗时异常","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"磁盘写入IOPS异常","cloud_cluster":"cloud-bj-center","device":"sdj","host_group":"glusterfs-prod","instance":"172.16.31.20","job":"node-exporter","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.31.20 主机组 glusterfs-prod 设备 sdj 磁盘写入IOPS异常,当前1364.4635536446356","key":"nodes.disk.write_iops_warning","summary":"主机 172.16.31.20 主机组 glusterfs-prod 设备 sdj 磁盘写入IOPS耗时异常","trigger":"1364.4635536446356"},"state":"PENDING","activeAt":"2021-04-13T10:08:43.659285132Z","value":"1.3644635536446356e+03","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"磁盘写入IOPS异常","cloud_cluster":"cloud-bj-center","device":"sdk","host_group":"glusterfs-prod","instance":"172.16.31.19","job":"node-exporter","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.31.19 主机组 glusterfs-prod 设备 sdk 磁盘写入IOPS异常,当前1350.9549681677277","key":"nodes.disk.write_iops_warning","summary":"主机 172.16.31.19 主机组 glusterfs-prod 设备 sdk 磁盘写入IOPS耗时异常","trigger":"1350.9549681677277"},"state":"PENDING","activeAt":"2021-04-13T10:09:13.659285132Z","value":"1.3509549681677277e+03","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"磁盘写入IOPS异常","cloud_cluster":"cloud-bj-center","device":"sdh","host_group":"glusterfs-prod","instance":"172.16.31.21","job":"node-exporter","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.31.21 主机组 glusterfs-prod 设备 sdh 磁盘写入IOPS异常,当前1411.3","key":"nodes.disk.write_iops_warning","summary":"主机 172.16.31.21 主机组 glusterfs-prod 设备 sdh 磁盘写入IOPS耗时异常","trigger":"1411.3"},"state":"PENDING","activeAt":"2021-04-13T10:09:13.659285132Z","value":"1.4113e+03","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.095928737,"lastEvaluation":"2021-04-13T18:09:15.390202749+08:00","type":"alerting"},{"state":"FIRING","name":"磁盘写入耗时异常","query":"irate(node_disk_write_time_seconds_total{device=~\"sd[a-z]\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[5m]) \u003e 10","duration":300,"labels":{"alertname":"磁盘写入耗时异常","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘写入耗时异常,当前{{ $value }}s","key":"nodes.disk.write_time_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘写入耗时异常","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"磁盘写入耗时异常","cloud_cluster":"cloud-bj-center","device":"sdc","host_group":"kvm-host-machine","instance":"172.16.23.36","job":"node-exporter","prometheus":"standard","type":"nodes.disk"},"annotations":{"description":"主机 172.16.23.36 主机组 kvm-host-machine 设备 sdc 磁盘写入耗时异常,当前64.36323333333712s","key":"nodes.disk.write_time_warning","summary":"主机 172.16.23.36 主机组 kvm-host-machine 设备 sdc 磁盘写入耗时异常","trigger":"64.36323333333712"},"state":"FIRING","activeAt":"2021-04-13T08:13:43.659285132Z","value":"6.436323333333712e+01","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.166792558,"lastEvaluation":"2021-04-13T18:09:14.197955109+08:00","type":"alerting"},{"state":"INACTIVE","name":"磁盘只读","query":"node_filesystem_readonly{fstype!~\"rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|udev|none|devpts|sysfs|debugfs|fuse.*\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",mountpoint!~\"/var/lib/(kubelet|heketi)/.*\"} == 1","duration":60,"labels":{"alertname":"磁盘只读","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 只读,当前{{ $value }}","key":"nodes.disk.readonly","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 只读","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.097996912,"lastEvaluation":"2021-04-13T18:09:14.364752001+08:00","type":"alerting"},{"state":"INACTIVE","name":"磁盘读取IOPS异常","query":"irate(node_disk_reads_completed_total{device=~\"sd[a-z]\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m]) \u003e 1000","duration":300,"labels":{"alertname":"磁盘读取IOPS异常","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘读取IOPS异常,当前{{ $value }}","key":"nodes.disk.read_iops_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘读取IOPS耗时异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.180023001,"lastEvaluation":"2021-04-13T18:09:13.784552393+08:00","type":"alerting"},{"state":"INACTIVE","name":"磁盘读取耗时异常","query":"irate(node_disk_read_time_seconds_total{device=~\"sd[a-z]\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[5m]) \u003e 5","duration":300,"labels":{"alertname":"磁盘读取耗时异常","type":"nodes.disk"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘读取耗时异常,当前{{ $value }}s","key":"nodes.disk.read_time_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 磁盘读取耗时异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.103702863,"lastEvaluation":"2021-04-13T18:09:13.964578536+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"nodes.gpu","file":"/thanos-prometheus/config/rules/nodes/gpu.rules","rules":[{"state":"INACTIVE","name":"GPU使用率达标","query":"avg_over_time(nvidia_gpu_duty_cycle{job=\"gpu-exporter\"}[1w]) \u003e 100","duration":604800,"labels":{"alertname":"GPU使用率达标","type":"nodes.gpu"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} GPU型号 {{ $labels.name }} 设备 {{ $labels.minor_number }} 过去24小时使用率达标,平均使用率 {{ $value | printf \"%.2f\"}}%","key":"nodes.gpu.avg_over_time_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} GPU型号 {{ $labels.name }} 设备 {{ $labels.minor_number }} 过去24小时平均使用率达标","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.574196136,"lastEvaluation":"2021-04-13T18:09:15.686002628+08:00","type":"alerting"},{"state":"INACTIVE","name":"GPU使用率过低","query":"max_over_time(nvidia_gpu_duty_cycle{job=\"gpu-exporter\"}[1w]) \u003c 0","duration":604800,"labels":{"alertname":"GPU使用率过低","type":"nodes.gpu"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} GPU型号 {{ $labels.name }} 设备 {{ $labels.minor_number }} 过去24小时最大使用率过低,最大值{{ $value | printf \"%.2f\" }}%","key":"nodes.gpu.max_over_time_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} GPU型号 {{ $labels.name }} 设备 {{ $labels.minor_number }} 过去24小时最大使用率过低","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.494754924,"lastEvaluation":"2021-04-13T18:09:16.260202405+08:00","type":"alerting"},{"state":"INACTIVE","name":"GPU温度预警","query":"nvidia_gpu_temperature_celsius{job=\"gpu-exporter\"} \u003e 80","duration":600,"labels":{"alertname":"GPU温度预警","type":"nodes.gpu"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} GPU型号 {{ $labels.name }} 设备 {{ $labels.minor_number }} 温度预警，当前{{ $value }}度","key":"nodes.gpu.nvidia_gpu_temperature_celsius_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} GPU型号 {{ $labels.name }} 设备 {{ $labels.minor_number }} 温度预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.030751882,"lastEvaluation":"2021-04-13T18:09:16.75496629+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"nodes.network","file":"/thanos-prometheus/config/rules/nodes/network.rules","rules":[{"state":"INACTIVE","name":"网卡上行丢弃包","query":"ceil(irate(node_network_transmit_drop_total{device!~\"(cali.*|veth.*|kube.*|vnet.*|lo|flannel.*|docker.*|virbr.*|br.*|ovs.*|tun.*|run.*|cni.*)\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m])) \u003e 100 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":300,"labels":{"alertname":"网卡上行丢弃包","type":"nodes.network"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备{{ $labels.device }} 上行数据包丢弃,个数{{ $value }}","key":"nodes.network.transmit_drop_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 上行数据包丢弃","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.210644924,"lastEvaluation":"2021-04-13T18:09:11.064803101+08:00","type":"alerting"},{"state":"INACTIVE","name":"网卡上行流量","query":"irate(node_network_transmit_bytes_total{device!~\"(cali.*|veth.*|kube.*|vnet.*|lo|flannel.*|docker.*|virbr.*|br.*|ovs.*|tun.*|run.*|cni.*)\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m]) / 1024 / 1024 \u003e 600 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":300,"labels":{"alertname":"网卡上行流量","type":"nodes.network"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 上行流量异常,速率{{ $value | printf \"%.2f\" }}MB/s","key":"nodes.network.transmit","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 上行流量异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.113956411,"lastEvaluation":"2021-04-13T18:09:10.457229621+08:00","type":"alerting"},{"state":"INACTIVE","name":"网卡上行错误包","query":"ceil(irate(node_network_transmit_errs_total{device!~\"(cali.*|veth.*|kube.*|vnet.*|lo|flannel.*|docker.*|virbr.*|br.*|ovs.*|tun.*|run.*|cni.*)\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m])) \u003e 100 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":300,"labels":{"alertname":"网卡上行错误包","type":"nodes.network"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 上行数据包错误,个数{{ $value }}","key":"nodes.network.transmit_error_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 上行数据包错误","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.192998167,"lastEvaluation":"2021-04-13T18:09:10.571193148+08:00","type":"alerting"},{"state":"INACTIVE","name":"网卡下行丢弃包","query":"ceil(irate(node_network_receive_drop_total{device!~\"(cali.*|veth.*|kube.*|vnet.*|lo|flannel.*|docker.*|virbr.*|br.*|ovs.*|tun.*|run.*|cni.*)\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m])) \u003e 100 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":300,"labels":{"alertname":"网卡下行丢弃包","type":"nodes.network"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 下行数据包丢弃,个数{{ $value }}","key":"nodes.network.receive_drop_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 下行数据包","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.191314204,"lastEvaluation":"2021-04-13T18:09:11.275461072+08:00","type":"alerting"},{"state":"INACTIVE","name":"网卡下行流量","query":"irate(node_network_receive_bytes_total{device!~\"(cali.*|veth.*|kube.*|vnet.*|lo|flannel.*|docker.*|virbr.*|br.*|ovs.*|tun.*|run.*|cni.*)\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m]) / 1024 / 1024 \u003e 600 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":300,"labels":{"alertname":"网卡下行流量","type":"nodes.network"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 下行流量异常,速率{{ $value | printf \"%.2f\" }}MB/s","key":"nodes.network.receive","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 下行流量异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.086731542,"lastEvaluation":"2021-04-13T18:09:10.978063732+08:00","type":"alerting"},{"state":"INACTIVE","name":"网卡下行错误包","query":"ceil(irate(node_network_receive_errs_total{device!~\"(cali.*|veth.*|kube.*|vnet.*|lo|flannel.*|docker.*|virbr.*|br.*|ovs.*|tun.*|run.*|cni.*)\",host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\"}[1m])) \u003e 100 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":300,"labels":{"alertname":"网卡下行错误包","type":"nodes.network"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 下行数据包错误,个数{{ $value }}","key":"nodes.network.receive_error_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 设备 {{ $labels.device }} 下行数据包错误","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.213858796,"lastEvaluation":"2021-04-13T18:09:10.764197564+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"nodes.process","file":"/thanos-prometheus/config/rules/nodes/process.rules","rules":[{"state":"INACTIVE","name":"D状态进程(等待IO进程)","query":"node_processes_state{host_group=~\"cloud-prod.*\",state=\"D\"} \u003e 20","duration":60,"labels":{"alertname":"D状态进程(等待IO进程)","type":"nodes.process"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 发现D状态进程,数量{{ $value }}","key":"nodes.base.process.d","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 发现D状态进程","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002527621,"lastEvaluation":"2021-04-13T18:09:05.558352642+08:00","type":"alerting"},{"state":"INACTIVE","name":"Z状态进程(僵尸进程)","query":"node_processes_state{host_group=~\"cloud-prod.*\",state=\"Z\"} \u003e 30","duration":60,"labels":{"alertname":"Z状态进程(僵尸进程)","type":"nodes.process"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 发现僵尸进程,数量{{ $value }}","key":"nodes.base.process.z","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 发现僵尸进程","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003202697,"lastEvaluation":"2021-04-13T18:09:05.536160856+08:00","type":"alerting"},{"state":"INACTIVE","name":"主机进程状态","query":"node_process_status == 0","duration":0,"labels":{"alertname":"主机进程状态","type":"nodes.process"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 上 项目 {{ $labels.project }} 服务进程 {{ $labels.app }} 状态异常,当前状态{{ $value }}","key":"nodes.base.process.status","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 上 项目 {{ $labels.project }} 服务进程 {{ $labels.app }} 状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002274349,"lastEvaluation":"2021-04-13T18:09:05.539367131+08:00","type":"alerting"},{"state":"INACTIVE","name":"活跃进程数","query":"node_procs_running{host_group!~\"|develop.*|unknown.*|Training.*\",job=~\"node-exporter\"} \u003e 800","duration":300,"labels":{"alertname":"活跃进程数","type":"nodes.process"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 活跃进程数{{ $value }}个存在风险","key":"nodes.base.node_procs_running","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 活跃进程数","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.007289507,"lastEvaluation":"2021-04-13T18:09:05.541645035+08:00","type":"alerting"},{"state":"INACTIVE","name":"进程IO阻塞","query":"node_procs_blocked{host_group!~\"|develop.*|unknown.*|Training.*\",job=~\"node-exporter\"} \u003e 10","duration":60,"labels":{"alertname":"进程IO阻塞","type":"nodes.process"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 发现阻塞进程{{ $value }}个","key":"nodes.base.io_blocked","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} 发现阻塞进程","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.009412724,"lastEvaluation":"2021-04-13T18:09:05.548937031+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"nodes.socket","file":"/thanos-prometheus/config/rules/nodes/sockets.rules","rules":[{"state":"FIRING","name":"主机TCP连接状态CloseWait","query":"node_tcp_connection_states{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",state=\"close_wait\"} \u003e 500","duration":300,"labels":{"alertname":"主机TCP连接状态CloseWait","type":"nodes.sockets"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} Close_Wait状态异常,当前{{ $value }}","key":"nodes.socket.closewait","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} Close_Wait状态异常","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"主机TCP连接状态CloseWait","cloud_cluster":"cloud-bj-center","host_group":"cloud-prod-4","instance":"172.16.31.28","job":"node-exporter","prometheus":"standard","state":"close_wait","type":"nodes.sockets"},"annotations":{"description":"主机 172.16.31.28 主机组 cloud-prod-4 Close_Wait状态异常,当前5696","key":"nodes.socket.closewait","summary":"主机 172.16.31.28 主机组 cloud-prod-4 Close_Wait状态异常","trigger":"5696"},"state":"FIRING","activeAt":"2021-02-25T19:02:59.993960111Z","value":"5.696e+03","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"主机TCP连接状态CloseWait","cloud_cluster":"cloud-bj-center","host_group":"bigdata","instance":"172.16.31.109","job":"node-exporter","prometheus":"standard","state":"close_wait","type":"nodes.sockets"},"annotations":{"description":"主机 172.16.31.109 主机组 bigdata Close_Wait状态异常,当前1887","key":"nodes.socket.closewait","summary":"主机 172.16.31.109 主机组 bigdata Close_Wait状态异常","trigger":"1887"},"state":"FIRING","activeAt":"2021-03-31T04:12:59.993960111Z","value":"1.887e+03","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.009139414,"lastEvaluation":"2021-04-13T18:09:00.001786159+08:00","type":"alerting"},{"state":"INACTIVE","name":"主机TCP连接状态FinWait2","query":"node_tcp_connection_states{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",state=\"fin_wait2\"} \u003e 500","duration":300,"labels":{"alertname":"主机TCP连接状态FinWait2","type":"nodes.sockets"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} Fin_Wait2状态异常,当前{{ $value }}","key":"nodes.socket.finwait2_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} Fin_Wait2状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.00483971,"lastEvaluation":"2021-04-13T18:08:59.994281521+08:00","type":"alerting"},{"state":"INACTIVE","name":"主机TCP连接状态SynSent","query":"node_tcp_connection_states{host_group!~\"|develop.*|unknown.*|Training.*\",job=\"node-exporter\",state=\"SynSent\"} \u003e 500","duration":300,"labels":{"alertname":"主机TCP连接状态SynSent","type":"nodes.sockets"},"annotations":{"description":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} Syn_Sent状态异常,当前{{ $value }}","key":"nodes.socket.synsent_warning","summary":"主机 {{ $labels.instance }} 主机组 {{ $labels.host_group }} Syn_Sent状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002658231,"lastEvaluation":"2021-04-13T18:08:59.999125154+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"others.cert","file":"/thanos-prometheus/config/rules/others/certs.rules","rules":[{"state":"INACTIVE","name":"域名过期","query":"domain_not_after \u003c 57 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":1200,"labels":{"alertname":"域名过期","type":"others.certs"},"annotations":{"description":"域名{{ $labels.domain }} 过期时间不足60天,剩余 {{ $value }} 天,过期时间为{{ $labels.expired }}","key":"others.cert.domain_not_after","summary":"域名 {{ $labels.domain }} 过期时间不足60天","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.092273406,"lastEvaluation":"2021-04-13T18:09:13.446342928+08:00","type":"alerting"},{"state":"FIRING","name":"证书过期","query":"ssl_cert_not_after \u003c 60 and on() hour() \u003e 0 \u003c 15 or on() hour() \u003e 22","duration":1200,"labels":{"alertname":"证书过期","type":"others.certs"},"annotations":{"description":"证书 {{ $labels.issuer_cn }} 过期时间不足60天,剩余 {{ $value }} 天,过期时间为 {{ $labels.expired }},所在服务器 {{ $labels.server }}","key":"others.cert.ssl_cert_not_after","summary":"证书 {{ $labels.issuer_cn }} 过期时间不足60天","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","domain":"*.airaman.com,airaman.com","expired":"2020-09-10 12:00:00","instance":"172.16.31.9:9999","issuer_cn":"GeoTrust CN RSA CA G1","job":"ssl-domain","prometheus":"standard","serial_no":"15591453386936651144739918671794143419","server":"47.92.134.204","subject_cn":"*.airaman.com","type":"others.certs"},"annotations":{"description":"证书 GeoTrust CN RSA CA G1 过期时间不足60天,剩余 -214.92143563605273 天,过期时间为 2020-09-10 12:00:00,所在服务器 47.92.134.204","key":"others.cert.ssl_cert_not_after","summary":"证书 GeoTrust CN RSA CA G1 过期时间不足60天","trigger":"-214.92143563605273"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"-2.1492143563605273e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","domain":"*.cloudminds.com,cloudminds.com","expired":"2020-10-10 12:00:00","instance":"172.16.31.9:9999","issuer_cn":"GeoTrust RSA CA 2018","job":"ssl-domain","prometheus":"standard","serial_no":"18367233634942244861580992493209170566","server":"10.11.35.49","subject_cn":"*.cloudminds.com","type":"others.certs"},"annotations":{"description":"证书 GeoTrust RSA CA 2018 过期时间不足60天,剩余 -184.9214356356387 天,过期时间为 2020-10-10 12:00:00,所在服务器 10.11.35.49","key":"others.cert.ssl_cert_not_after","summary":"证书 GeoTrust RSA CA 2018 过期时间不足60天","trigger":"-184.9214356356387"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"-1.849214356356387e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","domain":"*.cloudminds.com,cloudminds.com","expired":"2020-10-10 12:00:00","instance":"172.16.31.9:9999","issuer_cn":"GeoTrust RSA CA 2018","job":"ssl-domain","prometheus":"standard","serial_no":"18367233634942244861580992493209170566","server":"218.189.28.120","subject_cn":"*.cloudminds.com","type":"others.certs"},"annotations":{"description":"证书 GeoTrust RSA CA 2018 过期时间不足60天,剩余 -184.92143563588797 天,过期时间为 2020-10-10 12:00:00,所在服务器 218.189.28.120","key":"others.cert.ssl_cert_not_after","summary":"证书 GeoTrust RSA CA 2018 过期时间不足60天","trigger":"-184.92143563588797"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"-1.8492143563588797e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","domain":"airaman.com,cpanel.airaman.com,mail.airaman.com,webmail.airaman.com,www.airaman.com","expired":"2021-06-01 13:28:46","instance":"172.16.31.9:9999","issuer_cn":"R3","job":"ssl-domain","prometheus":"standard","serial_no":"375089323781797570383582525960359404630946","server":"mail.airaman.com","subject_cn":"cpanel.airaman.com","type":"others.certs"},"annotations":{"description":"证书 R3 过期时间不足60天,剩余 49.140207881989845 天,过期时间为 2021-06-01 13:28:46,所在服务器 mail.airaman.com","key":"others.cert.ssl_cert_not_after","summary":"证书 R3 过期时间不足60天","trigger":"49.140207881989845"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"4.9140207881989845e+01","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","domain":"localhost,localhost.localdomain,ip-172-31-23-236,ip-172-31-23-236.ap-northeast-1.compute.internal","expired":"2019-07-10 06:07:15","instance":"172.16.31.9:9999","issuer_cn":"ip-172-31-23-236","job":"ssl-domain","prometheus":"standard","serial_no":"18332","server":"52.196.191.223","subject_cn":"ip-172-31-23-236","type":"others.certs"},"annotations":{"description":"证书 ip-172-31-23-236 过期时间不足60天,剩余 -643.1664009134969 天,过期时间为 2019-07-10 06:07:15,所在服务器 52.196.191.223","key":"others.cert.ssl_cert_not_after","summary":"证书 ip-172-31-23-236 过期时间不足60天","trigger":"-643.1664009134969"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"-6.431664009134969e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","expired":"2020-01-25 15:55:52","instance":"172.16.31.9:9999","issuer_cn":"localhost.localdomain","job":"ssl-domain","prometheus":"standard","serial_no":"16345","server":"52.77.230.223","subject_cn":"localhost.localdomain","type":"others.certs"},"annotations":{"description":"证书 localhost.localdomain 过期时间不足60天,剩余 -443.7576393388658 天,过期时间为 2020-01-25 15:55:52,所在服务器 52.77.230.223","key":"others.cert.ssl_cert_not_after","summary":"证书 localhost.localdomain 过期时间不足60天","trigger":"-443.7576393388658"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"-4.437576393388658e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","domain":"*.airaman.com,airaman.com","expired":"2020-09-10 12:00:00","instance":"172.16.31.9:9999","issuer_cn":"GeoTrust CN RSA CA G1","job":"ssl-domain","prometheus":"standard","serial_no":"15591453386936651144739918671794143419","server":"13.57.9.121","subject_cn":"*.airaman.com","type":"others.certs"},"annotations":{"description":"证书 GeoTrust CN RSA CA G1 过期时间不足60天,剩余 -214.92143563637197 天,过期时间为 2020-09-10 12:00:00,所在服务器 13.57.9.121","key":"others.cert.ssl_cert_not_after","summary":"证书 GeoTrust CN RSA CA G1 过期时间不足60天","trigger":"-214.92143563637197"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"-2.1492143563637197e+02","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"证书过期","cloud_cluster":"cloud-bj-center","domain":"*.airaman.com,airaman.com","expired":"2020-09-10 12:00:00","instance":"172.16.31.9:9999","issuer_cn":"GeoTrust CN RSA CA G1","job":"ssl-domain","prometheus":"standard","serial_no":"15591453386936651144739918671794143419","server":"35.238.229.19","subject_cn":"*.airaman.com","type":"others.certs"},"annotations":{"description":"证书 GeoTrust CN RSA CA G1 过期时间不足60天,剩余 -214.92143563612444 天,过期时间为 2020-09-10 12:00:00,所在服务器 35.238.229.19","key":"others.cert.ssl_cert_not_after","summary":"证书 GeoTrust CN RSA CA G1 过期时间不足60天","trigger":"-214.92143563612444"},"state":"FIRING","activeAt":"2021-04-13T01:00:13.44602523Z","value":"-2.1492143563612444e+02","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.013893252,"lastEvaluation":"2021-04-13T18:09:13.53862244+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"others.exporter","file":"/thanos-prometheus/config/rules/others/exporter.rules","rules":[{"state":"INACTIVE","name":"cloud-exporter存活探针","query":"cloud_exporter_up == 0","duration":300,"labels":{"alertname":"cloud-exporter存活探针","type":"others.exporter"},"annotations":{"description":"主机 {{ $labels.instance }} cloud_exporter 模块 {{ $labels.module }} 状态异常","key":"others.exporter.cloud_exporter_up","summary":"主机 {{ $labels.instance }} cloud_exporter 模块 {{ $labels.module }} 状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.017216692,"lastEvaluation":"2021-04-13T18:08:53.9655551+08:00","type":"alerting"},{"state":"INACTIVE","name":"es-exporter存活探针","query":"es_exporter_up == 0","duration":300,"labels":{"alertname":"es-exporter存活探针","type":"others.exporter"},"annotations":{"description":"主机 {{ $labels.node_ip }} es_exporter 模块 {{ $labels.module }} 状态异常","key":"others.exporter.es_exporter_up","summary":"主机 {{ $labels.node_ip }} es_exporter 模块 {{ $labels.module }} 状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003391184,"lastEvaluation":"2021-04-13T18:08:53.962158462+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"storage.ceph","file":"/thanos-prometheus/config/rules/storage/ceph.rules","rules":[{"state":"INACTIVE","name":"Ceph健康状态","query":"ceph_health_status != 1","duration":60,"labels":{"alertname":"Ceph健康状态","type":"storage.ceph"},"annotations":{"description":"ceph集群健康检查状态异常,ceph_health_status 为{{ $value }}","key":"storage.ceph.health_warning","summary":"Ceph集群健康检查状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.050033447,"lastEvaluation":"2021-04-13T18:09:16.275538426+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群IOPS","query":"ceph_client_io_ops \u003e 1000","duration":300,"labels":{"alertname":"Ceph集群IOPS","type":"storage.ceph"},"annotations":{"description":"Ceph集群IOPS过高,当前{{ $value }}","key":"storage.ceph.total_bytes_high_warning","summary":"Ceph集群IOPS过高,超过1000","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002623719,"lastEvaluation":"2021-04-13T18:09:16.045324712+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群OSD容量可用率","query":"(ceph_osd_avail_bytes / ceph_osd_bytes) * 100 \u003c 10","duration":86400,"labels":{"alertname":"Ceph集群OSD容量可用率","type":"storage.ceph"},"annotations":{"description":"Ceph集群{{ $labels.osd }}容量可用率低于10%,当前可用率{{ $value| printf \"%.2f\" }}%","key":"storage.ceph.osd_rate_warning","summary":"Ceph集群{{ $labels.osd }}容量可用率低于10%","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.062291867,"lastEvaluation":"2021-04-13T18:09:16.213243359+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群OSD文件系统apply延迟","query":"ceph_osd_perf_apply_latency_seconds * 1000 \u003e 10000","duration":300,"labels":{"alertname":"Ceph集群OSD文件系统apply延迟","type":"storage.ceph"},"annotations":{"description":"Ceph集群{{ $labels.osd }}IO apply延迟过高,当前{{ $value }}s","key":"storage.ceph.osd_apply_delay_warning","summary":"Ceph集群{{ $labels.osd }}IO apply延迟过高,超过10000","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002968835,"lastEvaluation":"2021-04-13T18:09:16.047952759+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群OSD文件系统commit延迟","query":"ceph_osd_perf_commit_latency_seconds * 1000 \u003e 10000","duration":300,"labels":{"alertname":"Ceph集群OSD文件系统commit延迟","type":"storage.ceph"},"annotations":{"description":"Ceph集群{{ $labels.osd }}IO commit延迟过高,当前{{ $value }}s","key":"storage.ceph.osd_commit_delay_warning","summary":"Ceph集群{{ $labels.osd }}IO commit延迟过高","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002229802,"lastEvaluation":"2021-04-13T18:09:16.061991053+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群OSD状态","query":"ceph_osds_down{cluster=\"ceph\"} != 0","duration":60,"labels":{"alertname":"Ceph集群OSD状态","type":"storage.ceph"},"annotations":{"description":"Ceph集群OSD掉线{{ $value }}个","key":"storage.ceph.status_osd","summary":"Ceph集群OSD掉线","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.01105973,"lastEvaluation":"2021-04-13T18:09:16.050927784+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群Quorum协议","query":"abs(delta(ceph_monitor_quorum_count[1m])) \u003e 1","duration":300,"labels":{"alertname":"Ceph集群Quorum协议","type":"storage.ceph"},"annotations":{"description":"Ceph集群Monitor节点Quorum变更{{ $value }}","key":"storage.ceph.quorum_warning","summary":"Ceph集群Monitor节点Quorum变更","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.050697035,"lastEvaluation":"2021-04-13T18:09:16.072845226+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群总容量","query":"(ceph_cluster_available_bytes / ceph_cluster_capacity_bytes) * 100 \u003c 8","duration":86400,"labels":{"alertname":"Ceph集群总容量","type":"storage.ceph"},"annotations":{"description":"Ceph集群容量过低,当前{{ $value | printf \"%.2f\" }}%","key":"storage.ceph.total_bytes_low_bytes","summary":"Ceph集群容量过低,不足8%","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.084587586,"lastEvaluation":"2021-04-13T18:09:16.325578741+08:00","type":"alerting"},{"state":"INACTIVE","name":"Ceph集群慢请求","query":"ceph_slow_requests \u003e 0","duration":60,"labels":{"alertname":"Ceph集群慢请求","type":"storage.ceph"},"annotations":{"description":"Ceph集群发现慢请求,当前{{ $value }}个","key":"storage.ceph.slow_requests_warning","summary":"Ceph集群发现慢请求","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.08969179,"lastEvaluation":"2021-04-13T18:09:16.123546524+08:00","type":"alerting"},{"state":"INACTIVE","name":"磁盘坏道检测","query":"disk_bad_sectors_status == 1","duration":30,"labels":{"alertname":"磁盘坏道检测","type":"storage.ceph"},"annotations":{"description":"主机 {{ $labels.node_ip }} 磁盘主节点 {{ $labels.master_node}} ，设备sg {{ $labels.sg_info }} Bad Blocks，当前值 {{ $value }}","key":"storage.ceph.bad_block","summary":"主机 {{ $labels.node_ip }} 磁盘主节点 {{ $labels.master_node}} ，设备sg {{ $labels.sg_info }} Bad Blocks","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.008615967,"lastEvaluation":"2021-04-13T18:09:16.064223186+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"storage.glusterfs","file":"/thanos-prometheus/config/rules/storage/glusterfs.rules","rules":[{"state":"INACTIVE","name":"GlusterFS_Brick_Inode剩余率","query":"(gluster_brick_inodes_free / gluster_brick_inodes_total) * 100 \u003c 10","duration":43200,"labels":{"alertname":"GlusterFS_Brick_Inode剩余率","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.host }} 上 {{ $labels.volume}} inode可用率过低,当前 {{ $value| printf \"%.2f\" }}%","key":"storage.glusterfs.inode_rate","summary":"GlusterFS主机 {{ $labels.host }} 上 {{ $labels.volume}} inode可用率过低","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.097242785,"lastEvaluation":"2021-04-13T18:09:05.848107465+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS_Brick_Inode未来48小时满额预警","query":"min by(volume) (predict_linear(gluster_brick_inodes_free[1h], 48 * 3600)) \u003c 0","duration":21600,"labels":{"alertname":"GlusterFS_Brick_Inode未来48小时满额预警","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} inode未来48小时满额预警,当前{{ $value | printf \"%.2f\" }}%","key":"storage.glusterfs.inode_predict_linear","summary":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} inode未来48小时满额预警","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.105786429,"lastEvaluation":"2021-04-13T18:09:05.661077724+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS_Brick剩余率","query":"(gluster_brick_capacity_free_bytes / gluster_brick_capacity_bytes_total) * 100 \u003c 10","duration":43200,"labels":{"alertname":"GlusterFS_Brick剩余率","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.host }} 上 {{ $labels.volume}} 可用率过低,当前 {{ $value | printf \"%.2f\" }}%","key":"storage.glusterfs.brick_free","summary":"GlusterFS主机 {{ $labels.host }} 上 {{ $labels.volume}} 可用率过低","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.101223882,"lastEvaluation":"2021-04-13T18:09:05.559847692+08:00","type":"alerting"},{"state":"PENDING","name":"GlusterFS_Brick未来48小时满额预警","query":"predict_linear(gluster_brick_capacity_free_bytes[2h], 48 * 3600) \u003c 0","duration":21600,"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} 未来48小时满额预警,当前{{ $value | printf \"%.2f\" }}%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} 未来48小时满额预警","trigger":"{{ $value }}"},"alerts":[{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_58768cbf62201deef23eb06ab4161ca8/brick_74b9ae683d4316e8365d10128552679a/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.19","instance":"172.16.31.19:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-5","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.19:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-3910266894.74%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.19:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-3.9102668947362766e+09"},"state":"PENDING","activeAt":"2021-04-13T04:32:35.559640429Z","value":"-3.9102668947362766e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_58768cbf62201deef23eb06ab4161ca8/brick_74b9ae683d4316e8365d10128552679a/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.19","instance":"172.16.31.19:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-6","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.19:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-3911196741.86%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.19:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-3.9111967418598747e+09"},"state":"PENDING","activeAt":"2021-04-13T04:32:35.559640429Z","value":"-3.9111967418598747e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_56d272aae16ac652f64bb84dd9f104b7/brick_28eb950934630939a9d39a46cfbc797c/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.22","instance":"172.16.31.22:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-4","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.22:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-4753167370.02%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.22:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-4.753167370020975e+09"},"state":"PENDING","activeAt":"2021-04-13T04:34:05.559640429Z","value":"-4.753167370020975e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_56d272aae16ac652f64bb84dd9f104b7/brick_28eb950934630939a9d39a46cfbc797c/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.22","instance":"172.16.31.22:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-5","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.22:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-4702800033.83%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.22:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-4.702800033825754e+09"},"state":"PENDING","activeAt":"2021-04-13T04:34:35.559640429Z","value":"-4.702800033825754e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_56d272aae16ac652f64bb84dd9f104b7/brick_28eb950934630939a9d39a46cfbc797c/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.22","instance":"172.16.31.22:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-6","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.22:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-4208017025.48%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.22:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-4.2080170254763956e+09"},"state":"PENDING","activeAt":"2021-04-13T04:39:05.559640429Z","value":"-4.2080170254763956e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_58768cbf62201deef23eb06ab4161ca8/brick_74b9ae683d4316e8365d10128552679a/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.19","instance":"172.16.31.19:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-7","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.19:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-3873618439.70%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.19:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-3.8736184397007284e+09"},"state":"PENDING","activeAt":"2021-04-13T04:33:05.559640429Z","value":"-3.8736184397007284e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_13de35a047bf8fd839f8b5b6c5aa7b20/brick_a2868e239456e0fc29153dd9d48ff937/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.20","instance":"172.16.31.20:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-6","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.20:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-4145756610.36%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.20:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-4.1457566103638763e+09"},"state":"PENDING","activeAt":"2021-04-13T04:38:35.559640429Z","value":"-4.1457566103638763e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_92634839f60c56cffa58acd5e7b6d5d7/brick_ee69975e17391d46717bcc123984017d/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.19","instance":"172.16.31.19:8080","job":"gluster-prod","prometheus":"standard","subvolume":"231_idoe-v3_stable-idoe-miner-1-data-distributed-replicate-1","type":"storage.glusterfs","volume":"231_idoe-v3_stable-idoe-miner-1-data"},"annotations":{"description":"GlusterFS主机 172.16.31.19:8080 上 231_idoe-v3_stable-idoe-miner-1-data 未来48小时满额预警,当前-90864593211.89%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.19:8080 上 231_idoe-v3_stable-idoe-miner-1-data 未来48小时满额预警","trigger":"-9.08645932118905e+10"},"state":"PENDING","activeAt":"2021-04-13T09:00:35.559640429Z","value":"-9.08645932118905e+10","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_13de35a047bf8fd839f8b5b6c5aa7b20/brick_a2868e239456e0fc29153dd9d48ff937/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.20","instance":"172.16.31.20:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_3ee9aaa3cebbb7175d1078de970a2099-distributed-replicate-7","type":"storage.glusterfs","volume":"vol_3ee9aaa3cebbb7175d1078de970a2099"},"annotations":{"description":"GlusterFS主机 172.16.31.20:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警,当前-4344691063.65%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.20:8080 上 vol_3ee9aaa3cebbb7175d1078de970a2099 未来48小时满额预警","trigger":"-4.344691063648076e+09"},"state":"PENDING","activeAt":"2021-04-13T04:38:05.559640429Z","value":"-4.344691063648076e+09","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_739e6a94271a9547c9db0e81b4b6260f/brick_d424d0e151a13793d728b43aceebd7c4/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.22","instance":"172.16.31.22:8080","job":"gluster-prod","prometheus":"standard","subvolume":"231_idoe-v3_stable-idoe-miner-0-data-distributed-replicate-1","type":"storage.glusterfs","volume":"231_idoe-v3_stable-idoe-miner-0-data"},"annotations":{"description":"GlusterFS主机 172.16.31.22:8080 上 231_idoe-v3_stable-idoe-miner-0-data 未来48小时满额预警,当前-100141712473.26%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.22:8080 上 231_idoe-v3_stable-idoe-miner-0-data 未来48小时满额预警","trigger":"-1.0014171247325604e+11"},"state":"PENDING","activeAt":"2021-04-13T09:04:35.559640429Z","value":"-1.0014171247325604e+11","partialResponseStrategy":"ABORT"},{"labels":{"alertname":"GlusterFS_Brick未来48小时满额预警","brick_path":"/var/lib/heketi/mounts/vg_e97a7ea0bb57173e407c40d929761c04/brick_2bc41e9d151327354e15460cbb874d80/brick","cloud_cluster":"cloud-bj-center","cluster_id":"default","glusterfs":"prod","host":"10.51.2.19","instance":"172.16.31.19:8080","job":"gluster-prod","prometheus":"standard","subvolume":"vol_2c1827c3bd2bf2a667023cb5c593bc9b-replicate-0","type":"storage.glusterfs","volume":"vol_2c1827c3bd2bf2a667023cb5c593bc9b"},"annotations":{"description":"GlusterFS主机 172.16.31.19:8080 上 vol_2c1827c3bd2bf2a667023cb5c593bc9b 未来48小时满额预警,当前-258628087.29%","key":"storage.glusterfs.brick_predict_linear","summary":"GlusterFS主机 172.16.31.19:8080 上 vol_2c1827c3bd2bf2a667023cb5c593bc9b 未来48小时满额预警","trigger":"-2.586280872879529e+08"},"state":"PENDING","activeAt":"2021-04-13T09:34:35.559640429Z","value":"-2.586280872879529e+08","partialResponseStrategy":"ABORT"}],"health":"ok","evaluationTime":0.118285989,"lastEvaluation":"2021-04-13T18:09:06.076822715+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS_Brick状态","query":"gluster_volume_brick_status == 0","duration":300,"labels":{"alertname":"GlusterFS_Brick状态","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.hostname }} 上 {{ $labels.volume_name }} 状态异常,状态Down","key":"storage.glusterfs.status_brick","summary":"GlusterFS主机 {{ $labels.hostname }} 上 {{ $labels.volume_name }} 状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.054302583,"lastEvaluation":"2021-04-13T18:09:06.020127009+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS_Peer状态","query":"gluster_peer_connected != 1","duration":300,"labels":{"alertname":"GlusterFS_Peer状态","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.instance }} 集群连接异常,状态{{ $value }}","key":"storage.glusterfs.status_peer","summary":"GlusterFS主机 {{ $labels.instance }} 集群连接异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002386276,"lastEvaluation":"2021-04-13T18:09:06.074434153+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS_Volume占用CPU","query":"gluster_cpu_percentage \u003e 90","duration":600,"labels":{"alertname":"GlusterFS_Volume占用CPU","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} 占用大量CPU,当前 {{ $value | printf \"%.2f\" }}%","key":"storage.glusterfs.cpu_percentage","summary":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} 占用大量CPU","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.059131502,"lastEvaluation":"2021-04-13T18:09:05.769521901+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS_Volume占用内存","query":"gluster_memory_percentage \u003e 80","duration":600,"labels":{"alertname":"GlusterFS_Volume占用内存","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} 占用大量内存,当前 {{ $value | printf \"%.2f\" }}%","key":"storage.glusterfs.memory_percentage","summary":"GlusterFS主机 {{ $labels.instance }} 上 {{ $labels.volume}} 占用大量内存","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.067873047,"lastEvaluation":"2021-04-13T18:09:05.945355772+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS主进程状态","query":"glusterfsd_process_status == 0","duration":60,"labels":{"alertname":"GlusterFS主进程状态","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS集群{{ $labels.instance }}主进程状态异常，状态{{ $value }}服务Down","key":"storage.glusterfs.process_state","summary":"GlusterFS集群{{ $labels.instance }}主进程状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.006888628,"lastEvaluation":"2021-04-13T18:09:06.013233354+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS磁盘使用率","query":"(gluster_device_free / gluster_device_size) * 100 \u003c 10","duration":86400,"labels":{"alertname":"GlusterFS磁盘使用率","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS集群 {{ $labels.hostname }} 环境设备 {{ $labels.device }} 使用率过低,当前值{{ $value | printf \"%.2f\" }}%","key":"storage.glusterfs.disk_rate","summary":"GlusterFS集群 {{ $labels.hostname }} 环境设备 {{ $labels.device }} 使用率过低","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002649682,"lastEvaluation":"2021-04-13T18:09:05.766870141+08:00","type":"alerting"},{"state":"INACTIVE","name":"GlusterFS集群磁盘设备繁忙率","query":"cloud_storage_disk_uitls \u003e 90","duration":600,"labels":{"alertname":"GlusterFS集群磁盘设备繁忙率","type":"storage.glusterfs"},"annotations":{"description":"GlusterFS主机 {{ $labels.instance}} 设备 {{ $labels.device }} 设备util过高,当前{{ $value | printf \"%.2f\" }}%","key":"storage.glusterfs.disk_uitls_warning","summary":"GlusterFS主机 {{ $labels.instance}} 设备 {{ $labels.device }} 设备util过高","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.01944496,"lastEvaluation":"2021-04-13T18:09:05.828660314+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"},{"name":"storage.rgw","file":"/thanos-prometheus/config/rules/storage/rgw.rules","rules":[{"state":"INACTIVE","name":"RGW上行流量","query":"sum by(host) (rate(nginx_vts_server_bytes_total{direction=\"out\",host!=\"*\",publicservice=\"cloud-rgw-gateway\"}[1m])) / 1024 / 1024 \u003e 1024","duration":120,"labels":{"alertname":"RGW上行流量","type":"storage.rgw"},"annotations":{"description":"RGW请求 {{ $labels.host }} 站点上行流量异常,当前值{{ $value | printf \"%.2f\"  }}","key":"storage.rgw.transmit","summary":"RGW请求 {{ $labels.host }} 站点上行流量异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.00377825,"lastEvaluation":"2021-04-13T18:09:06.554525978+08:00","type":"alerting"},{"state":"INACTIVE","name":"RGW下行流量","query":"sum by(host) (rate(nginx_vts_server_bytes_total{direction=\"in\",host!=\"*\",publicservice=\"cloud-rgw-gateway\"}[1m])) / 1024 / 1024 \u003e 1024","duration":120,"labels":{"alertname":"RGW下行流量","type":"storage.rgw"},"annotations":{"description":"RGW请求 {{ $labels.host }} 站点下行流量异常,当前值{{ $value | printf \"%.2f\"  }}","key":"storage.rgw.receive","summary":"RGW请求 {{ $labels.host }} 站点下行流量异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003347481,"lastEvaluation":"2021-04-13T18:09:06.564786509+08:00","type":"alerting"},{"state":"INACTIVE","name":"RGW响应耗时","query":"nginx_vts_upstream_response_seconds{publicservice=\"cloud-rgw-gateway\"} \u003e 1","duration":60,"labels":{"alertname":"RGW响应耗时","type":"storage.rgw"},"annotations":{"description":"RGW后端 {{ $labels.backend }} 响应耗时异常，当前值{{ $value }}s","key":"storage.rgw.response_seconds","summary":"RGW后端 {{ $labels.backend }} 响应耗时异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.002369144,"lastEvaluation":"2021-04-13T18:09:06.562414958+08:00","type":"alerting"},{"state":"INACTIVE","name":"RGW状态4xx","query":"nginx_vts_server_requests_total{code=~\"4xx\",host!=\"*\",publicservice=\"cloud-rgw-gateway\"} - nginx_vts_server_requests_total{code=~\"4xx\",host!=\"*\",publicservice=\"cloud-rgw-gateway\"} offset 1m \u003e 1000","duration":60,"labels":{"alertname":"RGW状态4xx","type":"storage.rgw"},"annotations":{"description":"RGW请求 {{ $labels.host }} 站点4xx状态异常,当前值{{ $value }}","key":"storage.rgw.4xx","summary":"RGW请求 {{ $labels.host }} 站点4xx状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.004103129,"lastEvaluation":"2021-04-13T18:09:06.558308325+08:00","type":"alerting"},{"state":"INACTIVE","name":"RGW状态5xx","query":"nginx_vts_server_requests_total{code=~\"5xx\",host!=\"*\",publicservice=\"cloud-rgw-gateway\"} - nginx_vts_server_requests_total{code=~\"5xx\",host!=\"*\",publicservice=\"cloud-rgw-gateway\"} offset 1m \u003e 0","duration":60,"labels":{"alertname":"RGW状态5xx","type":"storage.rgw"},"annotations":{"description":"RGW请求 {{ $labels.host }} 站点5xx状态异常,当前值{{ $value }}","key":"storage.rgw.5xx","summary":"RGW请求 {{ $labels.host }} 站点5xx状态异常","trigger":"{{ $value }}"},"alerts":[],"health":"ok","evaluationTime":0.003927159,"lastEvaluation":"2021-04-13T18:09:06.55059325+08:00","type":"alerting"}],"interval":30,"evaluationTime":0,"lastEvaluation":"0001-01-01T00:00:00Z","partial_response_strategy":"WARN","partialResponseStrategy":"ABORT"}]}}
